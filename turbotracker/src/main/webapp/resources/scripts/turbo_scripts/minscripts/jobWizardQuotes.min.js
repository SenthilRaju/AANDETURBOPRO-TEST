var aGlobalVariable,aBidderDialogVar,aAddEditQuote,aGlobalConstant,aCancelQuote,aTypeDetail,aRevision,aQuoteTypeName,newDialogDiv=jQuery(document.createElement("div"));loadBidListGrid();setTimeout("loadQuotesGrid()",1);var aSysAdmin=$("#userAdminID").val(),jobStatus=getUrlVars().jobStatus;"Booked"===jobStatus&&$(".customerNameField").attr("disabled",!0);jQuery(document).ready(function(){$(".datepicker").datepicker();$("#donedate").hide();$("#granteddate").hide();requestSubstitutionDialog();$("#loadingDiv").css({visibility:"hidden"});loadQuoteTemplates();});
function saveANDcloseQuote(){var a=$("#jobNumberHiddenID").val(),b=$("#quoteTypeDetail").val(),c=$("#jobQuoteRevision").val();if("add"===aGlobalVariable){if(!$("#quoteManipulateForm").validationEngine("validate"))return!1;if(c.match(/^-\d+$/)||"+"===c||"-"===c)return jQuery(newDialogDiv).html('<span><b style="color:red;">Please Provide a Valuable Number.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),
!1;saveQuoteDetailInfo();null!==data1&&jQuery("#addquotes").dialog("close")}else if("edit"===aGlobalVariable){if(""===$("#quoteTypeDetail").val())return jQuery(newDialogDiv).html('<span><b style="color:red;">Please Provide "Type"</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;if(""===$("#jobQuoteSubmittedBYFullName").val())return jQuery(newDialogDiv).attr("id","msgDlg"),
jQuery(newDialogDiv).html('<span><b style="color:red;">Please Provide "Submitted By."</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;if(!$("#quoteManipulateForm").validationEngine("validate"))return!1;if(c.match(/^-\d+$/)||"+"===c||"-"===c)return jQuery(newDialogDiv).html('<span><b style="color:red;">Please Provide a Valuable Number.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,
width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;saveQuoteDetailInfo();aListDetailId="";jQuery("#addquotes").dialog("close")}else if("copy"===aGlobalVariable){if(""===$("#quoteTypeDetail").val())return jQuery(newDialogDiv).html('<span><b style="color:red;">Please Provide "Type"</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),
!1;if(b===aQuoteTypeName&&""===$("#jobQuoteRevision").val())return errorText="Please Add revision value.",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;if(b===aQuoteTypeName&&$("#jobQuoteRevision").val()===aRevision)return errorText="Please Change revision value.",
jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;if(""===$("#jobQuoteSubmittedBYFullName").val())return jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">Please Provide "Submitted By."</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,
width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;if(!$("#quoteManipulateForm").validationEngine("validate"))return!1;if(c.match(/^-\d+$/)||"+"===c||"-"===c)return jQuery(newDialogDiv).html('<span><b style="color:red;">Please Provide a Valuable Number.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),
!1;$.ajax({url:"./jobtabs2/checkQuoteTypeAndRev",type:"GET",data:{jobNumber:a,quoteType:b,quoteRev:c},success:function(a){if(a)return jQuery(newDialogDiv).html("<span><b style=\"color:red;\">A Quote with Same Type and Revision already exist. Please change 'Type' or 'Revision' to Copy Quote.</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:350,height:170,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close");trigger("reloadGrid")}}]}).dialog("open"),!1;saveQuote();
jQuery("#addquotes").dialog("close");return!0}})}return!0}function cancelQuote(){aCancelQuote="cancelQuoteList";for(var a=jQuery("#addquotesList").getRowData(),b="",c=0;c<a.length;c++)b=a[c].joQuoteHeaderID;deleteQuickQuote(b,aCancelQuote);$("#quoteManipulateForm").validationEngine("hideAll");jQuery("#addquotes").dialog("close");return $("#addQuotesView").css("display","none")}
function cancelEditQuote(){if(""!==$("#joDetailID").val())for(var a=$("#joDetailID").val().split(","),b=a.length,b=b-1,c=0;c<=b;c++)deleteDetailFrom(a[c]);$("#quoteManipulateForm").validationEngine("hideAll");jQuery("#addquotes").dialog("close");return $("#editQuotesView").css("display","none")}
function cancelCopyQuote(){aCancelQuote="cancelQuoteList";var a=$("#joHeaderID").val();deleteQuickQuote(a,aCancelQuote);$("#quoteManipulateForm").validationEngine("hideAll");jQuery("#addquotes").dialog("close");return $("#copyQuotesView").css("display","none")}
function planAndSpec(){var a=$("#planandSpecFormID").serialize(),b=$("#joMasterHiddenID").val();$.ajax({url:"./jobtabs2/planAndSpec",data:a+"&joMasterID="+b,mType:"GET",success:function(a){var b=a.planDate,d=a.binNumber;a=a.planNumbers;$("#plan_date_format").val(customFormatDateTime(b));$("#bin_number").val(d);$("#plan_nuber_id").val(a)}});jQuery("#planandSpecDialog").dialog("close")}
jQuery(function(){jQuery("#planandSpecDialog").dialog({autoOpen:!1,modal:!0,title:"Plan & Spec",height:250,width:300,buttons:{},close:function(){return!0}})});function openPlanandSpec(){jQuery("#planandSpecDialog").dialog("open")}function openPriorApproval(){jQuery("#priorApprovalDialog").dialog("open")}jQuery(function(){jQuery("#priorApprovalDialog").dialog({autoOpen:!1,modal:!0,title:"Prior Approval",height:250,width:250,buttons:{},close:function(){return!0}})});
function closeApproval(){jQuery("#priorApprovalDialog").dialog("close")}function openSource(){jQuery("#sourceDialog").dialog("open")}jQuery(function(){jQuery("#sourceDialog").dialog({autoOpen:!1,modal:!0,title:"Source",height:270,width:250,buttons:{},close:function(){return!0}})});function closeSource(){jQuery("#sourceDialog").dialog("close")}function openAddendums(){jQuery("#addendumsDialog").dialog("open")}
jQuery(function(){jQuery("#addendumsDialog").dialog({autoOpen:!1,modal:!0,title:"Addendums",height:270,width:250,buttons:{},close:function(){return!0}})});function updateAddendums(){var a=$("#addendumsForm").serialize(),b=$("#joMasterHiddenID").val();$.ajax({url:"./jobtabs2/updateAddendums",data:a+"&joMasterID="+b,mType:"GET",success:function(a){var b=a.addendumQuotedThru;a=a.addendumReceived;$("#received_id").val(a);$("#quoteThru_id").val(b)}});jQuery("#addendumsDialog").dialog("close")}
function openAmount(){jQuery("#amountDialog").dialog("open")}jQuery(function(){jQuery("#amountDialog").dialog({autoOpen:!1,modal:!0,title:"Amount",height:250,width:330,buttons:{},close:function(){return!0}})});jQuery(function(){jQuery("#BidDialogCustom").dialog({autoOpen:!1,modal:!0,title:"Add/Edit Bidder",width:520,left:300,top:290,buttons:{},close:function(){$("#BidDialogCustomForm").validationEngine("hideAll");return!0}})});
function submitBid(){if("add"===aBidderDialogVar){if(!$("#BidDialogCustomForm").validationEngine("validate"))return!1;saveBidderNaavigatorList();jQuery("#BidDialogCustom").dialog("close")}else if("edit"===aBidderDialogVar){if(!$("#BidDialogCustomForm").validationEngine("validate"))return!1;saveBidderNaavigatorList();$("#BidDialogCustomForm").validationEngine("hideAll");jQuery("#BidDialogCustom").dialog("close")}return!0}
function saveBidderNaavigatorList(){var a=$("#BidDialogCustomForm").serialize();"add"===aBidderDialogVar?$.ajax({url:"./jobtabs2/manpulateQuotebidList",type:"POST",async:!1,data:a+"&oper="+aBidderDialogVar,success:function(a){$("#quotesBidlist").trigger("reloadGrid")}}):"edit"===aBidderDialogVar&&$.ajax({url:"./jobtabs2/manpulateQuotebidList",type:"POST",async:!1,data:a+"&oper="+aBidderDialogVar,success:function(a){$("#quotesBidlist").trigger("reloadGrid")}});return!0}
jQuery(function(){jQuery("#contactCustom").dialog({autoOpen:!1,modal:!0,title:"Add Contact",width:400,left:300,top:290,buttons:{},close:function(){$("#contactForm").validationEngine("hideAll");var a=$("#rxMasterId").val();$.ajax({url:"./jobtabs2/filterBidderList",mType:"GET",data:{rxMasterId:a},success:function(a){var c='<select style="width:227px;margin-left: 3px;" id="contactId" onchange="getContactId()"><option value="-1"></option><option value="-2" style="color:#CB842E;font-family: Verdana,Arial,sans-serif;font-weight: bold;">+ Add New</option>';
$.each(a,function(a,b){quoteId=b.id;c+="<option value="+quoteId+">"+b.value+"</option>"});c+="</select>";$("#contacthiddenID").hide();$("#contactselectID").empty();$("#contactselectID").append(c)}});getContactId=function(){var a=$("#contactId").val();"-2"===a&&openContact();$("#rxContactId").val(a)};return!0}})});
function openContact(){$("#firstName").val("");$("#jobPosition").val("");$("#email").val("");$("#directLine").val("");$("#area").val("");$("#exchange").val("");$("#subscriber").val("");$("#division").val("");$("#lastName").val("");jQuery("#contactCustom").dialog("open")}
function cancelContact(){$("#contactForm").validationEngine("hideAll");jQuery("#contactCustom").dialog("close");var a=$("#rxMasterId").val();$.ajax({url:"./jobtabs2/filterBidderList",mType:"GET",data:{rxMasterId:a},success:function(a){var c='<select style="width:227px;margin-left: 3px;" id="contactId" onchange="getContactId()"><option value="-1"></option><option value="-2" style="color:#CB842E;font-family: Verdana,Arial,sans-serif;font-weight: bold;">+ Add New</option>';$.each(a,function(a,b){quoteId=
b.id;c+="<option value="+quoteId+">"+b.value+"</option>"});c+="</select>";$("#contacthiddenID").hide();$("#contactselectID").empty();$("#contactselectID").append(c)}});getContactId=function(){var a=$("#contactId").val();"-2"===a&&openContact();$("#rxContactId").val(a)}}
function submitContact(){if(!$("#contactForm").validationEngine("validate"))return!1;var a=$("#contactForm").serialize(),b=$("#rxMasterId").val(),c=$("#area").val(),e=$("#exchange").val(),d=$("#subscriber").val(),g=" ";""!==c&&(g="("+c+") "+e+"-"+d);var f;$.ajax({url:"./jobtabs2/addContact",type:"POST",data:a+"&rxMasterId="+b+"&cell="+g,success:function(a){f=a.rxContactId;$.ajax({url:"./jobtabs2/filterBidderList",mType:"GET",data:{rxMasterId:b},success:function(a){var b='<select style="width:227px;margin-left: 3px;" id="contactId" onchange="getContactId()"><option value="-1"></option><option value="-2" style="color:#CB842E;font-family: Verdana,Arial,sans-serif;font-weight: bold;">+ Add New</option>';
$.each(a,function(a,c){quoteId=c.id;b+="<option value="+quoteId+">"+c.value+"</option>"});b+="</select>";$("#contacthiddenID").hide();$("#contactselectID").empty();$("#contactselectID").append(b)}});getContactId=function(){var a=$("#contactId").val();"-2"===a&&openContact();$("#rxContactId").val(a)};setTimeout("$('#contactId option[value="+f+"]').attr('selected','selected')",50);$("#rxContactId").val(f)}});jQuery("#contactCustom").dialog("close");return!0}
function cancelBid(){$("#BidDialogCustomForm").validationEngine("hideAll");jQuery("#BidDialogCustom").dialog("close")}
function openAddBid(){aBidderDialogVar="add";$("#bidderId").val("");$("#bidder").val("");$("#low").attr("checked",!1);$("#contactId").empty();$("#customer_quoteType option[value=-1]").attr("selected",!0);$("#lastQuote").val("");$("#rev").val("");$("#jobNumber").val($(".jobHeader_JobNumber").val());$("#rxMasterId").val("");$("#joMasterId").val("");$("#rxContactId").val("");$("#rep").val("");$("#bidderIDTD").hide();$("#lowBiddderID").hide();$("#quoteTypeID").hide();$("#lastQuoteBidderID").hide();$("#revBidderID").hide();
$("#jobNumberBidderID").hide();$("#rxMasterBidderID").hide();$("#joMasterBidderID").hide();$("#rxContactIdBidderID").hide();$("#repBidderID").hide();jQuery("#BidDialogCustom").dialog("open")}
$(function(){var a={},b="";$("#bidder").autocomplete({minLength:3,timeout:1E3,select:function(a,b){var d=b.item.id;$("#rxMasterId").val(d);$.ajax({url:"./jobtabs2/filterQuoteTypeID",mType:"GET",data:{rxMasterId:d},success:function(a){$("#customer_quoteType option[value="+a.cuMasterTypeId+"]").attr("selected",!0)}});$.ajax({url:"./jobtabs2/filterBidderList",mType:"GET",data:{rxMasterId:d},success:function(a){var b='<select style="width:227px;margin-left: 3px;" id="contactId" onchange="getContactId()"><option value="-1"></option><option value="-2" style="color:#CB842E;font-family: Verdana,Arial,sans-serif;font-weight: bold;">+ Add New</option>';
$.each(a,function(a,c){quoteId=c.id;b+="<option value="+quoteId+">"+c.value+"</option>"});b+="</select>";$("#contacthiddenID").hide();$("#contactselectID").empty();$("#contactselectID").append(b)}});getContactId=function(){var a=$("#contactId").val();"-2"===a&&openContact();$("#rxContactId").val(a)}},source:function(c,e){var d=c.term;d in a?e(a[d]):b=$.getJSON("jobtabs2/bidderList",c,function(c,f,h){a[d]=c;h===b&&e(c)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
function closeAmount(){jQuery("#amountDialog").dialog("close")}jQuery(function(){jQuery("#addquotes").dialog({autoOpen:!1,height:750,width:1150,top:1E3,position:[$(window).width()/2-575,190],modal:!0,title:"Add/Edit Quote",iframe:!0,open:function(a,b){jQuery(".ui-dialog-titlebar-close").removeClass("ui-dialog-titlebar-close").hide()},buttons:{},close:function(){jQuery(this).dialog("close")}})});
function planAndSpecJobChange(){$("#isPlanAndSpecJob").is(":checked")?($("#planAndSpecJobTable").show(),$("#priorapproval").show()):($("#planAndSpecJobTable").hide(),$("#priorapproval").hide())}function PriorApproval(){$("#isPriorApproval").is(":checked")?$("#priorApproval").show():$("#priorApproval").hide()}function Source(){$("#isSource").is(":checked")?($("#sourcehidden").show(),$("#reporthidden").show()):($("#sourcehidden").hide(),$("#reporthidden").hide())}
function Addendums(){$("#isAddendums").is(":checked")?$("#addendums").show():$("#addendums").hide()}function Amount(){$("#isAmount").is(":checked")?$("#amounthiiden").show():$("#amounthiiden").hide()}function customCurrencyFormatter(a,b,c){return formatCurrency(a)}
function addquotesdialog(){aGlobalConstant=aGlobalVariable="add";$("#editQuotesView").empty();$("#copyQuotesView").empty();$("#addQuotesView").empty();$("#addQuotesView").append('<input type="button" class="savehoverbutton turbo-tan" value="Save & Close" onclick="saveANDcloseQuote()" style=" width:125px;">&nbsp;<input type="button" class="cancelhoverbutton turbo-tan"  value="Cancel" onclick="cancelQuote()" style="width:80px;">');jQuery("#joQuoteheader").text(0);loadQuotesListDetails();var a=$("#loginNameHiddenID").val(),
b=$("#userUDHiddenID").val(),c=$("#userInitialsHiddenID").val();$("#jobQuoteSubmittedBYFullName").val(a);$("#jobQuoteSubmittedBYID").val(b);$("#quoteDiscountedPrice").val(formatCurrency(0));$("#quoteTypeDetailID").val("");$("#quoteTypeDetail").val("");$("#jobQuoteRevision").val("");$("#jobQuoteInternalNote").val("");$("#quoteRemarksID").val("");$("#joHeaderID").val("");$("#joDetailID").val("");$("#jobQuoteSubmittedBYInitials").val(c);$("#quoteTypeDetail option[value=-1]").attr("selected",!0);$("#addquotesList").jqGrid("setGridParam",
{postData:{joQuoteHeaderID:0}});$("#addquotesList").trigger("reloadGrid");jQuery("#addquotes").dialog("open")}
function editQuoteDetails(){aGlobalConstant=aGlobalVariable="edit";$("#addQuotesView").empty();$("#copyQuotesView").empty();$("#editQuotesView").empty();$("#editQuotesView").append('<input type="button" class="savehoverbutton turbo-tan" value="Save & Close" onclick="saveANDcloseQuote()" style=" width:125px;">&nbsp;<input type="button" class="cancelhoverbutton turbo-tan"  value="Cancel" onclick="cancelEditQuote()" style="width:80px;">');aCancelQuote="";var a=$("#quotes"),b=a.jqGrid("getGridParam",
"selrow");if(null===b)return jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">Please click one of the Quote to Edit.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var c=a.jqGrid("getCell",b,"joQuoteHeaderID"),e=a.jqGrid("getCell",b,"quoteTypeID"),d=a.jqGrid("getCell",b,"createdByID"),g=a.jqGrid("getCell",b,"createdByName"),
f=a.jqGrid("getCell",b,"createdBYFullName"),h=a.jqGrid("getCell",b,"rev"),l=a.jqGrid("getCell",b,"internalNote"),k=a.jqGrid("getCell",b,"quoteRemarks"),a=a.jqGrid("getCell",b,"discountAmount");$("#quoteDiscountedPrice").val(a);$("#jobQuoteSubmittedBYFullName").val(f);$("#jobQuoteSubmittedBYID").val(d);$("#jobQuoteSubmittedBYInitials").val(g);$("#jobQuoteRevision").val(h);$("#jobQuoteInternalNote").val(l);$("#quoteRemarksID").val(k);$("#joDetailID").val("");$("#quoteTypeDetail option[value="+e+"]").attr("selected",
!0);$("#addquotesList").jqGrid("GridUnload");loadQuotesListDetails();$("#addquotesList").jqGrid("setGridParam",{postData:{joQuoteHeaderID:c}});$("#addquotesList").trigger("reloadGrid");jQuery("#joQuoteheader").text(c);$("#joHeaderID").val(c);jQuery("#addquotes").dialog("open");return!0}
function onDoubleClickEditQuoteDetails(a){aGlobalConstant=aGlobalVariable="edit";$("#addQuotesView").empty();$("#copyQuotesView").empty();$("#editQuotesView").empty();$("#editQuotesView").append('<input type="button" class="savehoverbutton turbo-tan" value="Save & Close" onclick="saveANDcloseQuote()" style=" width:125px;">&nbsp;<input type="button" class="cancelhoverbutton turbo-tan"  value="Cancel" onclick="cancelEditQuote()" style="width:80px;">');aCancelQuote="";var b=$("#quotes").jqGrid("getCell",
a,"joQuoteHeaderID"),c=$("#quotes").jqGrid("getCell",a,"quoteTypeID"),e=$("#quotes").jqGrid("getCell",a,"createdByID"),d=$("#quotes").jqGrid("getCell",a,"createdByName"),g=$("#quotes").jqGrid("getCell",a,"createdBYFullName"),f=$("#quotes").jqGrid("getCell",a,"rev"),h=$("#quotes").jqGrid("getCell",a,"internalNote"),l=$("#quotes").jqGrid("getCell",a,"quoteRemarks"),k=$("#quotes").jqGrid("getCell",a,"discountAmount"),q=$("#quotes").jqGrid("getCell",a,"displayQuantity"),n=$("#quotes").jqGrid("getCell",
a,"printQuantity"),m=$("#quotes").jqGrid("getCell",a,"displayParagraph"),r=$("#quotes").jqGrid("getCell",a,"printParagraph"),s=$("#quotes").jqGrid("getCell",a,"displayManufacturer"),u=$("#quotes").jqGrid("getCell",a,"printManufacturer"),p=$("#quotes").jqGrid("getCell",a,"displayCost"),t=$("#quotes").jqGrid("getCell",a,"printCost"),w=$("#quotes").jqGrid("getCell",a,"displayPrice"),v=$("#quotes").jqGrid("getCell",a,"printPrice"),y=$("#quotes").jqGrid("getCell",a,"displayMult"),z=$("#quotes").jqGrid("getCell",
a,"printMult"),x=$("#quotes").jqGrid("getCell",a,"displaySpec"),A=$("#quotes").jqGrid("getCell",a,"printSpec"),B=$("#quotes").jqGrid("getCell",a,"notesFullWidth"),C=$("#quotes").jqGrid("getCell",a,"lineNumbers"),D=$("#quotes").jqGrid("getCell",a,"printTotal");a=$("#quotes").jqGrid("getCell",a,"hidePrice");$("#quoteTypeDetail option[value="+c+"]").attr("selected",!0);$("#quoteDiscountedPrice").val(k);$("#jobQuoteSubmittedBYFullName").val(g);$("#jobQuoteSubmittedBYID").val(e);$("#jobQuoteSubmittedBYInitials").val(d);
$("#jobQuoteRevision").val(f);$("#jobQuoteInternalNote").val(h);$("#quoteRemarksID").val(l);$("#quantityValueDisplayID").val(q);$("#quantityValuePrintID").val(n);$("#quantityValueDisplayParaID").val(m);$("#quantityValuePrintParaID").val(r);$("#quantityValueDisplayManufID").val(s);$("#quantityValuePrintManufID").val(u);$("#quantityValueDisplaySpecID").val(x);$("#quantityValuePrintSpecID").val(A);$("#quantityValueprintCostID").val(p);$("#quantityValuePrintCostID").val(t);$("#quantityValueDispalyMultiID").val(y);
$("#quantityValueprintMultiID").val(z);$("#quantityValueDisplayPriceID").val(w);$("#quantityValuePrintPriceID").val(v);$("#inlineNotePage").val(B);$("#printLineID").val(C);$("#summationID").val(D);$("#showTotallingID").val(a);$("#inlineNotePage").val();$("#joDetailID").val("");$("#addquotesList").jqGrid("GridUnload");loadQuotesListDetails();$("#addquotesList").jqGrid("setGridParam",{postData:{joQuoteHeaderID:b}});$("#addquotesList").trigger("reloadGrid");jQuery("#joQuoteheader").text(b);$("#joHeaderID").val(b);
jQuery("#addquotes").dialog("open");return!0}
function editBidDetails(){aBidderDialogVar="edit";var a=$("#quotesBidlist"),b=a.jqGrid("getGridParam","selrow");if(null===b)return jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">Please click one of the Bidder to Edit.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var c=a.jqGrid("getCell",b,"bidderId"),e=a.jqGrid("getCell",
b,"bidder"),d=a.jqGrid("getCell",b,"low"),g=a.jqGrid("getCell",b,"quoteTypeID"),f=a.jqGrid("getCell",b,"lastQuote").split("> "),h=a.jqGrid("getCell",b,"rev"),l=a.jqGrid("getCell",b,"jobNumber"),k=a.jqGrid("getCell",b,"rxMasterId"),q=a.jqGrid("getCell",b,"joMasterId"),n=a.jqGrid("getCell",b,"rxContactId"),a=a.jqGrid("getCell",b,"rep");$("#customer_quoteType option[value="+g+"]").attr("selected",!0);$("#bidderId").val(c);$("#bidder").val(e);"Yes"===d?$("#low").attr("checked",!0):$("#low").attr("checked",
!1);$("#rev").val(h);$("#lastQuote").val(f[1]);$("#jobNumber").val(l);$("#rxMasterId").val(k);$("#joMasterId").val(q);$("#rxContactId").val(n);$("#rep").val(a);$("#bidderIDTD").hide();$("#lowBiddderID").show();$("#quoteTypeID").hide();$("#lastQuoteBidderID").show();$("#revBidderID").show();$("#jobNumberBidderID").hide();$("#rxMasterBidderID").hide();$("#joMasterBidderID").hide();$("#rxContactIdBidderID").hide();$("#repBidderID").hide();$.ajax({url:"./jobtabs2/filterBidderList",mType:"GET",data:{rxMasterId:k},
success:function(a){var b='<select style="width:227px;margin-left: 3px;" id="contactId" onchange="getContactId()"><option value="-1"></option><option value="-2" style="color:#CB842E;font-family: Verdana,Arial,sans-serif;font-weight: bold;">+ Add New</option>';$.each(a,function(a,c){quoteId=c.id;b+="<option value="+quoteId+">"+c.value+"</option>"});b+="</select>";$("contacthiddenID").hide();$("#contactselectID").empty();$("#contactselectID").append(b)}});getContactId=function(){var a=$("#contactId").val();
"-2"===a&&openContact();$("#rxContactId").val(a)};setTimeout("$('#contactId option[value="+n+"]').attr('selected','selected')",1E3);jQuery("#BidDialogCustom").dialog("open");return!0}
function parseRequestValues(){var a=$("#source1HiddenID").val(),b=$("#source2HiddenID").val(),c=$("#source3HiddenID").val(),e=$("#source4HiddenID").val(),d=$("#planAndSpecJobHiddenID").val();"true"===a&&$("#sourceDodge").attr("checked",!0);"true"===b&&$("#sourceISqft").attr("checked",!0);"true"===c&&$("#sourceLDI").attr("checked",!0);"true"===e&&$("#sourceOther").attr("checked",!0);"true"===d?($("#isPlanAndSpecJob").attr("checked",!0),$("#planAndSpecJobTable").show()):$("#planAndSpecJobTable").hide();
return!0}function done(){$("#donecheck").is(":checked")?$("#donedate").show():$("#donedate").hide()}function granted(){$("#grantedcheck").is(":checked")?$("#granteddate").show():$("#granteddate").hide()}function requestsubstitutiondialog(){jQuery("#requestSubstitution").dialog("open")}
function requestSubstitutionDialog(){jQuery("#requestSubstitution").dialog({autoOpen:!1,height:820,width:880,title:"Request For Substitution",modal:!0,buttons:{Submit:function(){},Cancel:function(){jQuery(this).dialog("close")}},close:function(){return!0}});return!0}
function saveQuoteDetailInfo(a){var b=0,c=$("#quoteManipulateForm").serialize();"edit"===aGlobalVariable&&(b=$("#joHeaderID").val(),c=c+"&joHeaderQuoteID="+b);if(!0!==a){if("-1"===$("#quoteTypeDetail").val())return jQuery(newDialogDiv).html('<span><b style="color:red;">Please Provide "Type"</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;if(0===jQuery("#addquotesList").getGridParam("records"))return jQuery(newDialogDiv).html('<span><b style="color:red;">Add  atleast one Line item</b></span>'),
jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Alert Message.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1}a=jQuery("#addquotesList").getRowData();for(var e=0,d=0,g=$("#quoteDiscountedPrice").val().replace(/[^0-9\.]+/g,""),g=Number(g),f=0;f<a.length;f++)var h=a[f],l=h.cost.replace(/[^0-9\.]+/g,""),e=e+Number(l),h=h.price.replace(/[^0-9\.]+/g,""),d=d+Number(h);!1===b&&(b="");var k="";$.ajax({url:"./jobtabs2/SaveQuoteDetailInfo",type:"POST",
async:!1,data:c+"&jobNumber="+$("#jobNumber_ID").text()+"&token="+aGlobalVariable+"&totalcost="+e+"&totalPrice="+d+"&joHeaderQuoteID="+b+"&quoteDiscountedPrice="+g+"&quoteRemarks="+$("#quoteRemarksID").val(),success:function(a){if("copy"===aGlobalVariable){for(var b=jQuery("#addquotesList").getRowData(),c=0;c<b.length;c++){var g=b[c],f=g.product,h=g.itemQuantity,l=g.rxManufacturerID,t=g.paragraph,w=g.veFactoryId,v=g.cost.replace(/[^0-9\.]+/g,"");e+=Number(v);g=g.price.replace(/[^0-9\.]+/g,"");d+=
Number(g);$.ajax({url:"./jobtabs2/manpulaterProductQuotes",type:"POST",data:"product="+f+"&paragraph="+t+"&rxManufacturerID="+l+"&itemQuantity="+h+"&cost="+v+"&oper=add&joQuoteHeaderID="+a+"&quoteheaderid="+a+"&veFactoryId="+w+"&price="+g,success:function(b){$("#joQuoteheader").text(joQuoteHeaderIdentity);$("#addquotesList").jqGrid("GridUnload");loadQuotesListDetails(a);$("#addquotesList").jqGrid("setGridParam",{postData:{joQuoteHeaderID:joQuoteHeaderIdentity}});$("#addquotesList").trigger("reloadGrid");
0===Number(joQuoteHeaderIdentity)&&($("#addquotesList").jqGrid("GridUnload"),loadQuotesListDetails(a),$("#addquotesList").jqGrid("setGridParam",{postData:{joQuoteHeaderID:name}}),$("#addquotesList").trigger("reloadGrid"))}})}k=a;$("#quotes").trigger("reloadGrid");jQuery(newDialogDiv).html('<span><b style="color:Green;">Quote details copied.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Success.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");
$("#joHeaderID").val(k);return!0}aGlobalVariable="edit";k=a;"addEditQuote"!==aAddEditQuote&&$("#quotes").trigger("reloadGrid");jQuery(newDialogDiv).html('<span><b style="color:Green;">Quote details updated.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Success.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");$("#joHeaderID").val(k);return!0},error:function(a,b,c){errorText=$(a.responseText).find("u").html();jQuery(newDialogDiv).html('<span><b style="color:red;">Error on modifying the data: '+
errorText+"</b></span>");jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Fatal Error.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!0}});return k}
$(function(){var a={},b="";$("#jobQuoteSubmittedBYFullName").autocomplete({minLength:1,timeout:1E3,select:function(a,b){var d=b.item.id;$("#jobQuoteSubmittedBYID").val(d);d=[];d=b.item.label.split("(");d=d[1].replace(")","");$("#jobQuoteSubmittedBYInitials").val(d)},source:function(c,e){var d=c.term;d in a?e(a[d]):b=$.getJSON("userlistcontroller/getuserautofilldata",c,function(c,f,h){a[d]=c;h===b&&e(c)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
function copyQuickQuote(){aGlobalVariable="copy";$("#addQuotesView").empty();$("#editQuotesView").empty();$("#copyQuotesView").empty();$("#copyQuotesView").append('<input type="button" class="savehoverbutton turbo-tan" value="Save & Close" onclick="saveANDcloseQuote()" style=" width:125px;">&nbsp;<input type="button" class="cancelhoverbutton turbo-tan"  value="Cancel" onclick="cancelCopyQuote()" style="width:80px;">');var a=$("#quotes"),b=a.jqGrid("getGridParam","selrow");if(null===b){var c="Please click one of the Quote to Copy.";
jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color:red;">'+c+"</b></span>");jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!1}var c=a.jqGrid("getCell",b,"joQuoteHeaderID"),e=a.jqGrid("getCell",b,"quoteTypeID"),d=a.jqGrid("getCell",b,"createdByID"),g=a.jqGrid("getCell",b,"createdByName"),f=a.jqGrid("getCell",b,"createdBYFullName"),h=a.jqGrid("getCell",
b,"rev"),l=a.jqGrid("getCell",b,"internalNote"),k=a.jqGrid("getCell",b,"quoteRemarks");aTypeDetail=e;aQuoteTypeName=quoteTypeDetail;aRevision=h;a=a.jqGrid("getCell",b,"discountAmount");$("#quoteDiscountedPrice").val(a);$("#jobQuoteSubmittedBYFullName").val(f);$("#jobQuoteSubmittedBYID").val(d);$("#jobQuoteSubmittedBYInitials").val(g);$("#jobQuoteRevision").val(h);$("#jobQuoteInternalNote").val(l);$("#quoteRemarksID").val(k);$("#joDetailID").val("");$("#quoteTypeDetail option[value="+e+"]").attr("selected",
!0);loadQuotesListDetails();jQuery("#joQuoteheader").text(c);$("#joHeaderID").val(c);saveQuoteDetail();jQuery("#addquotes").dialog("open");c=""!==h?"Please change to revision value.":"Please Add revision value.";jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color:red;">'+c+"</b></span>");jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!1}
function deleteQuickQuoteDialog(){if(null!==$("#quotes").jqGrid("getGridParam","selrow"))return jQuery(newDialogDiv).html('<span><b style="color: red;">Delete the Quote Record?</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:120,title:"Confirm Delete",buttons:{Submit:function(){var a=$("#quotes"),b=a.jqGrid("getGridParam","selrow"),a=a.jqGrid("getCell",b,"joQuoteHeaderID");aCancelQuote="";deleteQuickQuote(a,aCancelQuote);jQuery(this).dialog("close");$("#quotes").trigger("reloadGrid")},
Cancel:function(){jQuery(this).dialog("close")}}}).dialog("open"),!0;jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color:red;">Please click one of the Quote to Delete.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!1}
function deleteQuickQuote(a,b){$.ajax({url:"./jobtabs2/deleteQuoteDetailID",mType:"GET",data:{joHeaderQuoteID:a},success:function(c){deleteQuote(a,b)}})}
function deleteQuote(a,b){$.ajax({url:"./jobtabs2/deleteQuickQuote",mType:"GET",data:{joHeaderQuoteID:a},success:function(a){a="";a=""!==b?"Quote Cancelled":"Quote deleted successfully.";jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color: green;">'+a+"</b></span>");jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Information",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");$("#quotes").trigger("reloadGrid")}})}
function deleteBidDialog(){if(null!==$("#quotesBidlist").jqGrid("getGridParam","selrow"))return jQuery(newDialogDiv).html('<span><b style="color: red;">Delete the Bid Record?</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:120,title:"Confirm Delete",buttons:{Submit:function(){var a=$("#quotesBidlist"),b=a.jqGrid("getGridParam","selrow"),a=a.jqGrid("getCell",b,"bidderId");deleteBidQuote(a);jQuery(this).dialog("close");$("#quotesBidlist").trigger("reloadGrid")},Cancel:function(){jQuery(this).dialog("close")}}}).dialog("open"),
!0;jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color:red;">Please click one of the Bidder to Delete.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!1}
function deleteBidQuote(a){$.ajax({url:"./jobtabs2/deleteQuotebidList",mType:"GET",data:{selectBidderId:a},success:function(a){jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color: green;">Bid deleted successfully.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");$("#quotesBidlist").trigger("reloadGrid")}})}
function openPDF(a){var b=$("#quotesBidlist"),c=b.jqGrid("getGridParam","selrow");if(null===c)return a="Please click one of the Bidder to Export PDF.",jQuery(newDialogDiv).html('<span><b style="color:red;">'+a+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;if(0===jQuery("#quotes").getGridParam("records"))return a=b.jqGrid("getCell",c,"quoteType"),$("#loadingDiv").css({visibility:"hidden"}),
a="Please Add a Quote for '"+a+" Type' to save pdf.",jQuery(newDialogDiv).html('<span><b style="color:red;">'+a+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Message",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var e=1,d=1;$("#viewParagraphSaveAsPDFID").is(":checked")&&(e=0);$("#viewManufactureSaveAsPDFID").is(":checked")&&(d=0);var g=b.jqGrid("getCell",c,"bidder").replace("&","and").replace("#","_").replace("#",
"_").replace("#","_").replace("#","_").replace("#","_").replace("#","_").replace("&","and").replace("#","_").replace("#","_").replace("#","_").replace("#","_").replace("#","_").replace("#","_"),f=b.jqGrid("getCell",c,"contact").replace("&","and").replace("#","_").replace("#","_").replace("#","_").replace("#","_").replace("#","_").replace("#","_"),h=b.jqGrid("getCell",c,"quoteTypeID"),l=b.jqGrid("getCell",c,"rev"),k=b.jqGrid("getCell",c,"joMasterId");b.jqGrid("getCell",c,"quoteAmount");var b=$("#engineerHiddenID").val().replace("&",
"and").replace("&","and"),c=$("#architectHiddenID").val().replace("&","and").replace("&","and"),q=$("#bidDateHiddenID").val(),n=$("#projectNameHiddenID").val(),m=$("#plan_date_format").val(),r=$("#quoteThru_id").val(),s=$("#locationCityHiddenID").val(),u=$("#locationStateHiddenID").val(),p=new Date,p=p.getMonth()+1+"/"+p.getDate()+"/"+p.getFullYear(),t=$("#jobNumberHiddenID").val();"QuotePDF"===a?$.ajax({type:"GET",url:"./quotePDFController/SaveAsBidList",data:{enginnerName:b,architectName:c,bidDate:q,
projectName:n,planDate:m,locationCity:s,locationState:u,quoteTOName:g,bidderContact:f,quoteTypeID:h,quoteRev:l,joMasterID:k,QuoteThru:r,todayDate:p,jobNumber:t,paragraphCheck:e,manufactureCheck:d,QuotePDF:a},documenttype:"applicationpdf",async:!1,cache:!1,success:function(a){},error:function(a){}}):window.open("./quotePDFController/SaveAsBidList?enginnerName="+b+"&architectName="+c+"&bidDate="+q+"&projectName="+n+"&planDate="+m+"&locationCity="+s+"&locationState="+u+"&quoteTOName="+g+"&bidderContact="+
f+"&quoteTypeID="+h+"&quoteRev="+l+"&joMasterID="+k+"&QuoteThru="+r+"&todayDate="+p+"&jobNumber="+t+"&paragraphCheck="+e+"&manufactureCheck="+d+"&QuotePDF="+a);return!0}
function viewPDF(){var a=$("#quotes"),b=a.jqGrid("getGridParam","selrow");if(null===b)return jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">Please click one of the Quote to View.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var c=1,e=1;$("#viewParagraphID").is(":checked")&&(c=0);$("#viewManufactureID").is(":checked")&&
(e=0);var d=a.jqGrid("getCell",b,"joQuoteHeaderID"),g=a.jqGrid("getCell",b,"createdBYFullName"),f=a.jqGrid("getCell",b,"rev"),h=$("#engineerHiddenID").val().replace("&","and").replace("&","and"),l=$("#architectHiddenID").val().replace("&","and").replace("&","and"),k=$("#bidDateHiddenID").val(),q=$("#projectNameHiddenID").val(),n=$("#plan_date_format").val(),m=$("#locationCityHiddenID").val(),r=$("#locationStateHiddenID").val(),s=$("#quoteThru_id").val(),u=a.jqGrid("getCell",b,"quoteAmount"),a=a.jqGrid("getCell",
b,"discountAmount"),b=$("#jobNumberHiddenID").val(),p=new Date,p=p.getMonth()+1+"/"+p.getDate()+"/"+p.getFullYear();window.open("./quotePDFController/viewQuotePdfForm?enginnerName="+h+"&architectName="+l+"&bidDate="+k+" &projectName="+q+"&planDate="+n+"&locationCity="+m+"&locationState="+r+"&quoteTOName=&bidderContact=&joQuoteHeaderID="+d+"&totalPrice="+u+"&quoteRev="+f+"&QuoteThru="+s+"&todayDate="+p+"&jobNumber="+b+"&discountAmount="+a+"&quoteRemarks=()&paragraphCheck="+c+"&manufactureCheck="+e+
"&submittedBy="+g);return!0}
function sendEmail(){var a=$("#quotesBidlist"),b=a.jqGrid("getGridParam","selrow"),c="";if(null===b)return c="Please click one of the Bidder to Email Quote.",jQuery(newDialogDiv).html('<span><b style="color:red;">'+c+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var e=a.jqGrid("getCell",b,"contact"),d=a.jqGrid("getCell",b,"rxContactId"),g=a.jqGrid("getCell",b,"rev"),
f=a.jqGrid("getCell",b,"bidderId"),h=a.jqGrid("getCell",b,"joMasterId"),l=a.jqGrid("getCell",b,"quoteTypeID"),k=a.jqGrid("getCell",b,"quoteType");if(""===d)return c="Please Add Contact for Bidder.",jQuery(newDialogDiv).html('<span><b style="color:red;">'+c+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;$.ajax({url:"./jobtabs2/checkQuoteType",mType:"GET",data:{revision:g,
joBidderID:f,joMasterID:h,quoteTypeID:l},success:function(q){var n=q.quoteRev;if(null===q.joQuoteHeaderId)return c="Please Add a Quote for '"+k+" Type' to Send Mail.",jQuery(newDialogDiv).html('<span><b style="color:red;">'+c+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var m=a.jqGrid("getCell",b,"email"),r=$("#jobNumberHiddenID").val()+"  Quote for project:  "+
$("#projectNameHiddenID").val(),s="emailName='"+$("#emailNameHiddenID").val()+"'&emailAddr='"+$("#emailAddrHiddenID").val()+"'&logOnName='"+$("#logOnNameHiddenID").val()+"'&logOnPassword='"+$("#logOnPswdHiddenID").val()+"'&CCAddr1='"+$("#ccaddr1HiddenID").val()+"'&CCAddr2='"+$("#ccaddr2HiddenID").val()+"'&CCAddr3='"+$("#ccaddr3HiddenID").val()+"'&CCAddr4='"+$("#ccaddr4HiddenID").val()+"'&CCName1='"+$("#ccname1HiddenID").val()+"'&CCName2='"+$("#ccname2HiddenID").val()+"'&CCName3='"+$("#ccname3HiddenID").val()+
"'&CCName4='"+$("#ccname4HiddenID").val()+"'&BCCAddr='"+$("#bccaddrHiddenID").val()+"'&SMTPSer='"+$("#smtpsvrHiddenID").val()+"'&SMTPPort='"+$("#smtpportHiddenID").val()+"'&jobNumber='"+$("#jobNumberHiddenID").val()+"'";c=""===m&&""!==n?"Are you sure you want to send "+k+" 'Rev."+n+"' to "+e+"?":""===m?"Are you sure you want to send "+k+" to "+e+"?":""===n?"Are you sure you want to send "+k+" to "+e+" ("+m+")?":"Are you sure you want to send "+k+" 'Rev."+n+"' to "+e+"("+m+")?";jQuery(newDialogDiv).html('<span><b style="color:green;">'+
c+"</b></span>");jQuery(newDialogDiv).dialog({modal:!0,width:400,height:150,title:"Message",buttons:{Send:function(){sentMailFunction(m,r,d,g,f,s,h,l);jQuery(this).dialog("close")},Cancel:function(){jQuery(this).dialog("close")}}}).dialog("open");return!0}});return!0}
function sentMailFunction(a,b,c,e,d,g,f,h){""===a?(jQuery(newDialogDiv).html('<form id="mailToAddress"><table><tr><td><span><b style="color:red;">Please Provide a Mail ID.</b></span></td></tr><tr><td style="height: 5px;"></td></tr><tr><td><label>Mail ID: </label><input type="text" id="mailToAddress_ID" name="mailToAddress_name" class="validate[custom[email]]" style="width: 250px;" /></td></tr></table></form><hr>'),jQuery(newDialogDiv).dialog({modal:!0,width:430,height:180,title:"Message",buttons:{"Submit & Send":function(){if(!$("#mailToAddress").validationEngine("validate"))return!1;
var a=$("#mailToAddress_ID").val();saveMailAddress(a,c);$("#loadingDiv").css({visibility:"visible"});setTimeout(function(){if(0===jQuery("#quotes").getGridParam("records"))return $("#loadingDiv").css({visibility:"hidden"}),jQuery(newDialogDiv).html('<span><b style="color:green;">Please add a Quote to send mail.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Message",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;openPDF("QuotePDF");
sendMail(b,a,e,d,g,f,h);return!0},800);jQuery(this).dialog("close");return!0},Cancel:function(){jQuery(this).dialog("close")}}}).dialog("open")):($("#loadingDiv").css({visibility:"visible"}),setTimeout(function(){if(0===jQuery("#quotes").getGridParam("records"))return $("#loadingDiv").css({visibility:"hidden"}),jQuery(newDialogDiv).html('<span><b style="color:green;">Please add a Quote to send mail.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Message",buttons:[{height:35,
text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;openPDF("QuotePDF");sendMail(b,a,e,d,g,f,h);return!0},800));return!0}
function sendMail(a,b,c,e,d,g,f){$.ajax({url:"./sendMailServer/sendMail",type:"POST",data:d+"&subject='"+a+"'&toAddress='"+b+"'",success:function(a){$("#loadingDiv").css({visibility:"hidden"});jQuery(newDialogDiv).html('<span><b style="color:green;">Mail Sent Successfully.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Message",buttons:[{height:35,text:"OK",click:function(){var a=new Date,b=a.getDate(),d=a.getMonth()+1,h=a.getFullYear().toString().substr(2,2),m=a.getHours(),
a=a.getMinutes(),r=12<=m?"PM":"AM",m=(m%=12)?m:12;10>b&&(b="0"+b);10>d&&(d="0"+d);10>m&&(m="0"+m);10>a&&(a="0"+a);$.ajax({url:"./jobtabs2/updateLastQuoteAndRev",mType:"GET",data:{revision:c,joBidderID:e,joMasterID:g,quoteTypeID:f,quoteDate:d+"/"+b+"/"+h+" "+m+":"+a+" "+r},success:function(a){$("#quotesBidlist").jqGrid("GridUnload");loadBidListGrid();$("#quotesBidlist").trigger("reloadGrid")}});$("#quotesBidlist").jqGrid("GridUnload");loadBidListGrid();$("#quotesBidlist").trigger("reloadGrid");$(this).dialog("close")}}]}).dialog("open")}})}
function saveMailAddress(a,b){$.ajax({url:"./jobtabs2/updateEmailAddress",mType:"GET",data:{email:a,contactID:b},success:function(a){}})}
function faxQuote(){if(null===$("#quotesBidlist").jqGrid("getGridParam","selrow"))return jQuery(newDialogDiv).html('<span><b style="color:red;">Please click one of the Bidder to Fax Quote.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;jQuery(newDialogDiv).html('<span><b style="color:green;">This feature is in our workshop.  Will be released soon.  Thank you for your patience.</b></span>');
jQuery(newDialogDiv).dialog({modal:!0,width:340,height:170,title:"Information",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!0}
function saveQuoteDetail(){for(var a=0,b=$("#quoteManipulateForm").serialize(),c=jQuery("#addquotesList").getRowData(),e=0,d=0,g=0;g<c.length;g++)var f=c[g],h=f.cost.replace(/[^0-9\.]+/g,""),e=e+Number(h),f=f.price.replace(/[^0-9\.]+/g,""),d=d+Number(f);c=$("#quoteDiscountedPrice").val().replace(/[^0-9\.]+/g,"");c=Number(c);!1===a&&(a="");var l="";$.ajax({url:"./jobtabs2/SaveQuoteDetailInfo",type:"POST",async:!1,data:b+"&jobNumber="+$("#jobNumber_ID").text()+"&token="+aGlobalVariable+"&totalcost="+
e+"&totalPrice="+d+"&joHeaderQuoteID="+a+"&quoteRemarks="+$("#quoteRemarksID").val()+"&quoteDiscountedPrice="+c,success:function(a){if("copy"===aGlobalVariable){$("#headerIDForCopyQuote").val(a);var b=jQuery("#joQuoteheader").text(),c=$("#headerIDForCopyQuote").val();$.ajax({url:"./jobtabs2/getLineItemsForCopyQuote",type:"POST",data:{previousJoQuoteHeader:b,currentJoQuoteheaderID:c},success:function(a){$("#joQuoteheader").text(c);$("#addquotesList").jqGrid("GridUnload");loadQuotesListDetails();$("#addquotesList").jqGrid("setGridParam",
{postData:{joQuoteHeaderID:c}});$("#addquotesList").trigger("reloadGrid")}});l=a;$("#joHeaderID").val(l);return!0}}});return l}
function copyEachLineItem(){var a=$("#headerIDForCopyQuote").val(),b=jQuery("#addquotesList").getRowData();console.log(JSON.stringify(b));for(var c=0;c<b.length;c++){var e=b[c],d=e.product,g=e.itemQuantity,f=e.rxManufacturerID,h=e.paragraph,l=e.veFactoryId,k=e.inlineNote,q=e.productNote,n=e.cost.replace(/[^0-9\.]+/g,""),e=e.price.replace(/[^0-9\.]+/g,"");$.ajax({url:"./jobtabs2/manpulaterProductQuotes",type:"POST",data:"product="+d+"&paragraph="+h+"&rxManufacturerID="+f+"&itemQuantity="+g+"&inlineNote="+
k+"&footnote="+q+"&cost="+n+"&oper=add&joQuoteHeaderID="+a+"&quoteheaderid="+a+"&veFactoryId="+l+"&price="+e,success:function(b){$("#joQuoteheader").text(a);$("#addquotesList").jqGrid("GridUnload");loadQuotesListDetails();$("#addquotesList").jqGrid("setGridParam",{postData:{joQuoteHeaderID:a}});$("#addquotesList").trigger("reloadGrid")}})}}
function saveQuote(a){a=$("#joHeaderID").val();for(var b=$("#quoteManipulateForm").serialize(),c=jQuery("#addquotesList").getRowData(),e=$("#quoteTypeDetailID").val(),d=0,g=0,f=0;f<c.length;f++)var h=c[f],l=h.cost.replace(/[^0-9\.]+/g,""),d=d+Number(l),h=h.price.replace(/[^0-9\.]+/g,""),g=g+Number(h);var c=$("#quoteDiscountedPrice").val().replace(/[^0-9\.]+/g,""),c=Number(c),k="";$.ajax({url:"./jobtabs2/SaveQuoteInfo",type:"POST",async:!1,data:b+"&jobNumber="+$("#jobNumber_ID").text()+"&token="+aGlobalVariable+
"&totalcost="+d+"&totalPrice="+g+"&joHeaderQuoteID="+a+"&quoteRemarks="+$("#quoteRemarksID").val()+"&quoteDiscountedPrice="+c,success:function(a){if("copy"===aGlobalVariable){for(var b=jQuery("#addquotesList").getRowData(),c=0;c<b.length;c++){var f=b[c],h=f.joQuoteDetailID,l=f.product,p=f.itemQuantity,t=f.rxManufacturerID,w=f.paragraph,v=f.veFactoryId,y=f.inlineNote,z=f.productNote,x=f.cost.replace(/[^0-9\.]+/g,"");d+=Number(x);f=f.price.replace(/[^0-9\.]+/g,"");g+=Number(f);$.ajax({url:"./jobtabs2/manpulaProductQuotes",
type:"POST",data:"product="+l+"&joQuoteDetailID="+h+"&paragraph="+w+"&rxManufacturerID="+t+"&itemQuantity="+p+"&inlineNote="+y+"&footnote="+z+"&cost="+x+"&oper=add&joQuoteHeaderID="+a+"&quoteheaderid="+a+"&veFactoryId="+v+"&price="+f,success:function(b){$("#joQuoteheader").text(joQuoteHeaderIdentity);$("#addquotesList").jqGrid("GridUnload");loadQuotesListDetails();$("#addquotesList").jqGrid("setGridParam",{postData:{joQuoteHeaderID:a}});$("#addquotesList").trigger("reloadGrid");0===Number(a)&&($("#addquotesList").jqGrid("GridUnload"),
loadQuotesListDetails(),$("#addquotesList").jqGrid("setGridParam",{postData:{joQuoteHeaderID:name}}),$("#addquotesList").trigger("reloadGrid"))}})}k=a;$("#quotes").trigger("reloadGrid");aTypeDetail!==e?(errorText="Type value Changed And Quote details copied",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:green;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Information",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open")):
(jQuery(newDialogDiv).html('<span><b style="color:Green;">Quote details copied.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Success.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"));$("#joHeaderID").val(k);return!0}}});return k}function deleteQuoteNoRev(a,b){$.ajax({url:"./jobtabs2/deleteQuoteDetailID",mType:"GET",data:{joHeaderQuoteID:a},success:function(c){deleteQuick(a,b)}})}
function deleteQuick(a,b){$.ajax({url:"./jobtabs2/deleteQuickQuote",mType:"GET",data:{joHeaderQuoteID:a},success:function(a){$("#quotes").trigger("reloadGrid")}})}function deleteDetailFrom(a){$.ajax({url:"./jobtabs2/deleteQuickQuoteDetail",mType:"GET",data:{joHeaderQuoteDetailID:a},success:function(a){}});return!0}
function saveJobAmount(){var a=$("#contractAmount").val(),b=$("#estimatedCost").val(),c=$("#estimatedProfit").val(),a=a.replace(/[^0-9\.]+/g,""),a=Number(a),b=b.replace(/[^0-9\.]+/g,""),b=Number(b);c.replace(/[^0-9\.]+/g,"");var c=a-b,e=$("#joMasterHiddenID").val();$.ajax({url:"./jobtabs2/updateJobamount",mType:"GET",data:{joMasterID:e,ContractAmount:a,EstimateCost:b,EstimateProfit:c},success:function(a){errorText="Amount is updated";jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color:green;">'+
errorText+"</b></span>");jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Information",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close");window.location.reload()}}]}).dialog("open")}})}function trimContractAmount(){var a=$("#contractAmount").val().replace(/[^0-9\.]+/g,""),a=Number(a);$("#contractAmount").val(a)}function trimEstimatedCost(){var a=$("#estimatedCost").val().replace(/[^0-9\.]+/g,""),a=Number(a);$("#estimatedCost").val(a)}
function estimateProfit(){var a=$("#contractAmount").val(),b=$("#estimatedCost").val(),a=a.replace(/[^0-9\.]+/g,""),a=Number(a),b=b.replace(/[^0-9\.]+/g,""),b=Number(b),b=a-b;$("#estimatedProfit").val("");$("#estimatedProfit").val(b)}function cancelReport(){jQuery("#searchCriteria").dialog("close")}jQuery(function(){$(".datepicker").datepicker();jQuery("#searchCriteria").dialog({autoOpen:!1,width:486,title:"Report Criteria",modal:!0,buttons:{},close:function(){return!0}});return!0});
function reportCriteria(){jQuery("#searchCriteria").dialog("open")}function reportCriteriaPage(){document.location.href="./reportcriteria"}
function contractAmountAdminValidation(a){if("Booked"===jobStatus)if("1"!==aUserAdmin)jQuery(newDialogDiv).html('<span style="color:#FF0066;">You are not authorized to modify this field.  Admin only can change.</span>'),jQuery(newDialogDiv).dialog({modal:!0,title:"Booked Job Alert",width:400,buttons:[{height:30,text:"OK",click:function(){$(this).dialog("close");$("#contractAmount").val(formatCurrency($("#jobContractAmountHidden").val()));document.getElementById("contractAmount").disabled=!0}}]}).dialog("open");
else return a}
function estimateCostAdminValidation(a){if("Booked"===jobStatus)if("1"!==aUserAdmin)jQuery(newDialogDiv).html('<span style="color:#FF0066;">You are not authorized to modify this field.  Admin only can change.</span>'),jQuery(newDialogDiv).dialog({modal:!0,title:"Booked Job Alert",width:400,buttons:[{height:30,text:"OK",click:function(){$(this).dialog("close");$("#estimatedCost").val(formatCurrency($("#estomattedHiddenIDHidden").val()));document.getElementById("estimatedCost").disabled=!0}}]}).dialog("open");
else return a};