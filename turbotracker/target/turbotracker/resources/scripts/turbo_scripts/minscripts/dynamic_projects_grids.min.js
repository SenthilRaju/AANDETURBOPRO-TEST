jQuery(document).ready(function(){var b=$("#projectUserID").val();getSalesReps(b);$("#intro").hide();$("#search").hide();setTimeout("loadgrid()",1E3)});
var arrColNamesRelease=["Booked Date","Job #","Job Name"],arrColModelRelease=[{name:"bookedDate",index:"bookedDate",align:"center",width:60},{name:"jobNo",index:"jobNo",align:"center",width:30},{name:"jobName",index:"jobName",align:"",width:90}],arrColNamesDormantProjects=["Job #","Job Name","Customer"],arrColModelDormantProjects=[{name:"jobNo",index:"jobNo",align:"center",width:30},{name:"jobName",index:"jobName",align:"left",width:60},{name:"customer",index:"customer",align:"left",width:60}],arrColNamesOrderTracking=
["Purchase Order #","Order Date","Vendor"],arrColModelOrderTracking=[{name:"purchaseOrderNo",index:"purchaseOrderNo",align:"center",width:60},{name:"orderDate",index:"orderDate",align:"center",width:60},{name:"vendor",index:"vendor",align:"left",width:90}],colName_salesMan="SalesMan",colModel_salesMan={name:"assignedSalesman",index:"assignedSalesman",align:"center",width:50},colName_Customer="Customer",colModel_Customer={name:"customer",index:"customer",align:"center",width:50},colName_CustomerContact=
"Customer Contact",colModel_CustomerContactr={name:"cuStomerContact",index:"cuStomerContact",align:"center",width:50},colName_Engineer="Engineer",colModel_Engineer={name:"engineer",index:"engineer",align:"center",width:50},colName_ContractAmount="Contract Amount",colModel_ContractAmount={name:"contractAmount",index:"contractAmount",align:"center",width:50,formatter:customCurrencyFormatter},colName_CustContact="Customer Contact",colModel_CustContact={name:"customerContact",index:"customerContact",
align:"center",width:60},colName_Salesman="Salesman",colModel_Salesman={name:"salesMan",index:"salesman",align:"left",width:60},colName_LastActivityDate="Last Activity Date",colModel_LastActivityDate={name:"lastActivityDate",index:"lastActivityDate",align:"center",width:60},colName_vendor="Vendor",colModel_vendor={name:"vendor",index:"vendor",align:"left",width:90},colName_vendorOrderNo="Vendor Order #",colModel_vendorOrderNo={name:"vendorOrderNo",index:"vendorOrderNo",align:"left",width:60},colName_shipDate=
"Ship Date",colModel_shipDate={name:"shipDate",index:"shipDate",align:"left",width:60};function loadgrid(){pendingcreditordergrid(arrColNamesRelease,arrColModelRelease);pendingreleaseordergrid(arrColNamesRelease,arrColModelRelease);bookedreleasegrid(arrColNamesRelease,arrColModelRelease);dormantProjects_grid(arrColNamesDormantProjects,arrColModelDormantProjects);orderTracking_grid(arrColNamesOrderTracking,arrColModelOrderTracking);return!0}
function addRemoveBookedInSubmittalGridColumns(){for(var b=document.getElementsByClassName("BookedInSubmittal"),c=0;c<b.length;c++){var a=b[c];"checkbox"===a.type&&a.checked?"BookedDate"!=a.value&&("Job #"!=a.value&&"Job Name"!=a.value&&!isExistInArray(arrColNamesRelease,a.value))&&("SalesMan"===a.value&&!isExistInArray(arrColNamesRelease,"SalesMan")?(arrColNamesRelease.push(colName_salesMan),arrColModelRelease.push(colModel_salesMan)):"Customer"===a.value&&!isExistInArray(arrColNamesRelease,"Customer")?
(arrColNamesRelease.push(colName_Customer),arrColModelRelease.push(colModel_Customer)):"Customer Contact"===a.value&&!isExistInArray(arrColNamesRelease,"Customer Contact")?(arrColNamesRelease.push(colName_CustomerContact),arrColModelRelease.push(colModel_CustomerContactr)):"Engineer"===a.value&&!isExistInArray(arrColNamesRelease,"Engineer")?(arrColNamesRelease.push(colName_Engineer),arrColModelRelease.push(colModel_Engineer)):"Contract Amount"===a.value&&!isExistInArray(arrColNamesRelease,"Contract Amount")&&
(arrColNamesRelease.push(colName_ContractAmount),arrColModelRelease.push(colModel_ContractAmount))):"checkbox"===a.type&&!a.checked&&("SalesMan"===a.value?(removeA(arrColNamesRelease,colName_salesMan),removeA(arrColModelRelease,colModel_salesMan)):"Customer"===a.value?(removeA(arrColNamesRelease,colName_Customer),removeA(arrColModelRelease,colModel_Customer)):"Customer Contact"===a.value?(removeA(arrColNamesRelease,colName_CustomerContact),removeA(arrColModelRelease,colModel_CustomerContactr)):"Engineer"===
a.value?(removeA(arrColNamesRelease,colName_Engineer),removeA(arrColModelRelease,colModel_Engineer)):"Contract Amount"===a.value&&(removeA(arrColNamesRelease,colName_ContractAmount),removeA(arrColModelRelease,colModel_ContractAmount)))}$("#Booked").jqGrid("GridUnload");bookedreleasegrid(arrColNamesRelease,arrColModelRelease);$("#Booked").trigger("reloadGrid");return!0}
var bookedreleasegrid=function(b,c){var a=jQuery("#SalesRepComboList").val(),a=null===a?75:jQuery("#SalesRepComboList").val();$("#Booked").jqGrid({url:"projectscontroller/projects_submittal",datatype:"JSON",mtype:"GET",postData:{salesRepId:a},colNames:b,colModel:c,rowNum:1E3,pgbuttons:!1,recordtext:"",rowList:[],pgtext:null,viewrecords:!1,altRows:!0,altclass:"myAltRowClass",sortname:" ",sortorder:"asc",imgpath:"themes/basic/images",height:100,width:1130,rownumbers:!0,loadComplete:function(){},loadError:function(){},
jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"},ondblClickRow:function(){var a=$("#Booked").jqGrid("getGridParam","selrow"),b=$("#Booked").jqGrid("getCell",a,3),a=$("#Booked").jqGrid("getCell",a,2),b="token=view&"+getQryStr(a,b);document.location.href="./jobflow?"+b}})};function customCurrencyFormatter(b){return formatCurrency(b)}
function addRemovePendingOrderGridColumns(){for(var b=document.getElementsByClassName("PendingOrderOptions"),c=0;c<b.length;c++){var a=b[c];"checkbox"===a.type&&a.checked?"BookedDate"!=a.value&&("Job #"!=a.value&&"Job Name"!=a.value&&!isExistInArray(arrColNamesRelease,a.value))&&("SalesMan"===a.value&&!isExistInArray(arrColNamesRelease,"SalesMan")?(arrColNamesRelease.push(colName_salesMan),arrColModelRelease.push(colModel_salesMan)):"Customer"===a.value&&!isExistInArray(arrColNamesRelease,"Customer")?
(arrColNamesRelease.push(colName_Customer),arrColModelRelease.push(colModel_Customer)):"Customer Contact"===a.value&&!isExistInArray(arrColNamesRelease,"Customer Contact")?(arrColNamesRelease.push(colName_CustomerContact),arrColModelRelease.push(colModel_CustomerContactr)):"Engineer"===a.value&&!isExistInArray(arrColNamesRelease,"Engineer")?(arrColNamesRelease.push(colName_Engineer),arrColModelRelease.push(colModel_Engineer)):"Contract Amount"===a.value&&!isExistInArray(arrColNamesRelease,"Contract Amount")&&
(arrColNamesRelease.push(colName_ContractAmount),arrColModelRelease.push(colModel_ContractAmount))):"checkbox"===a.type&&!a.checked&&("SalesMan"===a.value?(removeA(arrColNamesRelease,colName_salesMan),removeA(arrColModelRelease,colModel_salesMan)):"Customer"===a.value?(removeA(arrColNamesRelease,colName_Customer),removeA(arrColModelRelease,colModel_Customer)):"Customer Contact"===a.value?(removeA(arrColNamesRelease,colName_CustomerContact),removeA(arrColModelRelease,colModel_CustomerContactr)):"Engineer"===
a.value?(removeA(arrColNamesRelease,colName_Engineer),removeA(arrColModelRelease,colModel_Engineer)):"Contract Amount"===a.value&&(removeA(arrColNamesRelease,colName_ContractAmount),removeA(arrColModelRelease,colModel_ContractAmount)))}$("#pendingOrderGrid").jqGrid("GridUnload");pendingreleaseordergrid(arrColNamesRelease,arrColModelRelease);$("#pendingOrderGrid").trigger("reloadGrid");return!0}
var pendingreleaseordergrid=function(b,c){var a=jQuery("#SalesRepComboList").val(),a=null===a?75:jQuery("#SalesRepComboList").val();$("#pendingOrderGrid").jqGrid({url:"projectscontroller/projects_pendingOrder",datatype:"JSON",mtype:"GET",postData:{salesRepId:a},colNames:b,colModel:c,rowNum:1E3,pgbuttons:!1,recordtext:"",rowList:[],pgtext:null,viewrecords:!1,altRows:!0,altclass:"myAltRowClass",sortname:" ",sortorder:"asc",imgpath:"themes/basic/images",height:100,width:1130,rownumbers:!0,loadComplete:function(){},
loadError:function(){},jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"},ondblClickRow:function(){var a=$("#pendingOrderGrid").jqGrid("getGridParam","selrow"),b=$("#pendingOrderGrid").jqGrid("getCell",a,3),a=$("#pendingOrderGrid").jqGrid("getCell",a,2),b="token=view&"+getQryStr(a,b);document.location.href="./jobflow?"+b}})};
function addRemovePendingCreditGridColumns(){for(var b=document.getElementsByClassName("PendingCreditOptions"),c=0;c<b.length;c++){var a=b[c];"checkbox"===a.type&&a.checked?"BookedDate"!=a.value&&("Job #"!=a.value&&"Job Name"!=a.value&&!isExistInArray(arrColNamesRelease,a.value))&&("SalesMan"===a.value&&!isExistInArray(arrColNamesRelease,"SalesMan")?(arrColNamesRelease.push(colName_salesMan),arrColModelRelease.push(colModel_salesMan)):"Customer"===a.value&&!isExistInArray(arrColNamesRelease,"Customer")?
(arrColNamesRelease.push(colName_Customer),arrColModelRelease.push(colModel_Customer)):"Customer Contact"===a.value&&!isExistInArray(arrColNamesRelease,"Customer Contact")?(arrColNamesRelease.push(colName_CustomerContact),arrColModelRelease.push(colModel_CustomerContactr)):"Engineer"===a.value&&!isExistInArray(arrColNamesRelease,"Engineer")?(arrColNamesRelease.push(colName_Engineer),arrColModelRelease.push(colModel_Engineer)):"Contract Amount"===a.value&&!isExistInArray(arrColNamesRelease,"Contract Amount")&&
(arrColNamesRelease.push(colName_ContractAmount),arrColModelRelease.push(colModel_ContractAmount))):"checkbox"===a.type&&!a.checked&&("SalesMan"===a.value?(removeA(arrColNamesRelease,colName_salesMan),removeA(arrColModelRelease,colModel_salesMan)):"Customer"===a.value?(removeA(arrColNamesRelease,colName_Customer),removeA(arrColModelRelease,colModel_Customer)):"Customer Contact"===a.value?(removeA(arrColNamesRelease,colName_CustomerContact),removeA(arrColModelRelease,colModel_CustomerContactr)):"Engineer"===
a.value?(removeA(arrColNamesRelease,colName_Engineer),removeA(arrColModelRelease,colModel_Engineer)):"Contract Amount"===a.value&&(removeA(arrColNamesRelease,colName_ContractAmount),removeA(arrColModelRelease,colModel_ContractAmount)))}$("#PendingCreditGrid").jqGrid("GridUnload");pendingcreditordergrid(arrColNamesRelease,arrColModelRelease);$("#PendingCreditGrid").trigger("reloadGrid");return!0}
var pendingcreditordergrid=function(b,c){var a=jQuery("#SalesRepComboList").val(),a=null===a?68:jQuery("#SalesRepComboList").val();$("#PendingCreditGrid").jqGrid({url:"projectscontroller/projects_pendingCredit",datatype:"JSON",mtype:"GET",postData:{salesRepId:a},colNames:b,colModel:c,rowNum:1E3,pgbuttons:!1,recordtext:"",rowList:[],pgtext:null,viewrecords:!1,altRows:!0,altclass:"myAltRowClass",sortname:" ",sortorder:"asc",imgpath:"themes/basic/images",height:100,width:1130,rownumbers:!0,loadComplete:function(){},
loadError:function(){},jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"},ondblClickRow:function(){var a=$("#PendingCreditGrid").jqGrid("getGridParam","selrow"),b=$("#PendingCreditGrid").jqGrid("getCell",a,3),a=$("#PendingCreditGrid").jqGrid("getCell",a,2),b="token=view&"+getQryStr(a,b);document.location.href="./jobflow?"+b}})};
function addRemoveDormantProjectsGridColumns(){for(var b=document.getElementsByClassName("DormantProjects"),c=0;c<b.length;c++){var a=b[c];"checkbox"===a.type&&a.checked?"Job #"!=a.value&&("Job Name"!=a.value&&"Customer"!=a.value&&!isExistInArray(arrColNamesDormantProjects,a.value))&&("Customer Contact"===a.value&&!isExistInArray(arrColNamesDormantProjects,"Customer Contact")?(arrColNamesDormantProjects.push(colName_CustContact),arrColModelDormantProjects.push(colModel_CustContact)):"Salesman"===
a.value&&!isExistInArray(arrColNamesDormantProjects,"Salesman")?(arrColNamesDormantProjects.push(colName_Salesman),arrColModelDormantProjects.push(colModel_Salesman)):"Last Activity Date"===a.value&&!isExistInArray(arrColNamesDormantProjects,"Last Activity Date")&&(arrColNamesDormantProjects.push(colName_LastActivityDate),arrColModelDormantProjects.push(colModel_LastActivityDate))):"checkbox"===a.type&&!a.checked&&("Customer Contact"===a.value?(removeA(arrColNamesDormantProjects,colName_CustContact),
removeA(arrColModelDormantProjects,colModel_CustContact)):"Salesman"===a.value?(removeA(arrColNamesDormantProjects,colName_Salesman),removeA(arrColModelDormantProjects,colModel_Salesman)):"Last Activity Date"===a.value&&(removeA(arrColNamesDormantProjects,colName_LastActivityDate),removeA(arrColModelDormantProjects,colModel_LastActivityDate)))}$("#dormantProjectsGrid").jqGrid("GridUnload");dormantProjects_grid(arrColNamesDormantProjects,arrColModelDormantProjects);$("#dormantProjectsGrid").trigger("reloadGrid");
return!0}
var dormantProjects_grid=function(b,c){var a=jQuery("#SalesRepComboList").val(),a=null===a?75:jQuery("#SalesRepComboList").val();$("#dormantProjectsGrid").jqGrid({url:"projectscontroller/projects_dormant",datatype:"JSON",mtype:"GET",postData:{salesRepId:a},pager:"",colNames:b,colModel:c,rowNum:1E3,pgbuttons:!1,recordtext:"",rowList:[],pgtext:null,viewrecords:!1,altRows:!0,altclass:"myAltRowClass",sortname:"employeeId",pgbuttons:!1,sortorder:"asc",imgpath:"themes/basic/images",caption:!1,height:100,
width:1130,rownumbers:!0,loadComplete:function(){},loadError:function(){},ondblClickRow:function(){var a=$("#dormantProjectsGrid").jqGrid("getGridParam","selrow"),b=$("#dormantProjectsGrid").jqGrid("getCell",a,2),a=$("#dormantProjectsGrid").jqGrid("getCell",a,1),b="token=view&"+getQryStr(a,b);document.location.href="./jobflow?"+b},jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"}});return!0};
function addRemoveOrderTrackingGridColumns(){for(var b=document.getElementsByClassName("orderTracking"),c=0;c<b.length;c++){var a=b[c];"checkbox"===a.type&&a.checked?"Purchase Order #"!=a.value&&("Order Date"!=a.value&&"Vendor"!=a.value&&!isExistInArray(arrColNamesOrderTracking,a.value))&&("Vendor Order #"===a.value&&!isExistInArray(arrColNamesOrderTracking,"Vendor Order #")?(arrColNamesOrderTracking.push(colName_vendorOrderNo),arrColModelOrderTracking.push(colModel_vendorOrderNo)):"Ship Date"===
a.value&&!isExistInArray(arrColNamesOrderTracking,"Ship Date")&&(arrColNamesOrderTracking.push(colName_shipDate),arrColModelOrderTracking.push(colModel_shipDate))):"checkbox"===a.type&&!a.checked&&("Vendor Order #"===a.value?(removeA(arrColNamesOrderTracking,colName_vendorOrderNo),removeA(arrColModelOrderTracking,colModel_vendorOrderNo)):"Ship Date"===a.value&&(removeA(arrColNamesOrderTracking,colName_shipDate),removeA(arrColModelOrderTracking,colModel_shipDate)))}$("#orderTrackingGrid").jqGrid("GridUnload");
orderTracking_grid(arrColNamesOrderTracking,arrColModelOrderTracking);$("#orderTrackingGrid").trigger("reloadGrid");return!0}
var orderTracking_grid=function(b,c){var a=jQuery("#SalesRepComboList").val(),a=null===a?75:jQuery("#SalesRepComboList").val();$("#orderTrackingGrid").jqGrid({url:"projectscontroller/projects_ordertracking",mtype:"GET",datatype:"JSON",postData:{salesRepId:a},pager:"",colNames:b,colModel:c,rowNum:1E3,pgbuttons:!1,recordtext:"",rowList:[],pgtext:null,viewrecords:!1,altRows:!0,altclass:"myAltRowClass",sortname:"employeeId",pgbuttons:!1,sortorder:"asc",imgpath:"themes/basic/images",caption:!1,height:100,
width:1130,rownumbers:!0,loadComplete:function(){},loadError:function(){},jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"}});return!0};
function changeSalesrep(){var b=jQuery("#SalesRepComboList").val();$("#Booked").jqGrid("setGridParam",{postData:{salesRepId:b}});$("#Booked").trigger("reloadGrid");$("#pendingOrderGrid").jqGrid("setGridParam",{postData:{salesRepId:b}});$("#pendingOrderGrid").trigger("reloadGrid");$("#PendingCreditGrid").jqGrid("setGridParam",{postData:{salesRepId:b}});$("#PendingCreditGrid").trigger("reloadGrid");$("#dormantProjectsGrid").jqGrid("setGridParam",{postData:{salesRepId:b}});$("#dormantProjectsGrid").trigger("reloadGrid");
$("#orderTrackingGrid").jqGrid("setGridParam",{postData:{salesRepId:b}});$("#orderTrackingGrid").trigger("reloadGrid");return!0}function getSalesReps(b){$.ajax({url:"./salescontroller",success:function(c){var a="";$.each(c,function(b,c){a=a+'<option value="'+c.userId+'">'+c.userName+"</option>"});$("#SalesRepComboList").append(a);$("#SalesRepComboList option[value="+b+"]").attr("selected",!0)},error:function(){}})}
function getQryStr(b,c){var a="";$.ajax({async:!1,url:"./search/searchjobcustomer",mType:"GET",data:{jobnumber:b,jobname:c},success:function(e){var d="",f="";$.each(e,function(a,b){f=b.jobStatus;d=b.customerName});null===d&&(d="");updateJobstatus(b,f);return a="jobNumber="+b+"&jobName="+c+"&jobCustomer="+d+""},error:function(){}});return a}function isExistInArray(b,c){return-1===jQuery.inArray(c,b)?!1:!0}
function removeA(b){for(var c,a=arguments,e=a.length,d;1<e&&b.length;)for(c=a[--e];-1!=(d=b.indexOf(c));)b.splice(d,1);return b}
function formatCurrency(b){if(""==b||null==b)return"$0.00";b=b.toString().replace(/\$|\,/g,"");dblValue=parseFloat(b);blnSign=dblValue==(dblValue=Math.abs(dblValue));dblValue=Math.floor(100*dblValue+0.50000000001);intCents=dblValue%100;strCents=intCents.toString();dblValue=Math.floor(dblValue/100).toString();10>intCents&&(strCents="0"+strCents);for(b=0;b<Math.floor((dblValue.length-(1+b))/3);b++)dblValue=dblValue.substring(0,dblValue.length-(4*b+3))+","+dblValue.substring(dblValue.length-(4*b+3));
return(blnSign?"":"-")+"$"+dblValue+"."+strCents};