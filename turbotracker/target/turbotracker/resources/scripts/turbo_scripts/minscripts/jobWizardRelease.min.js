var aReleaseDialogVar,aPurchaseOrderVar,aShipDialogVar,errorText,estimatedamountRelease,newDialogDiv=jQuery(document.createElement("div")),currentDate=new Date,currentMonth=currentDate.getMonth()+1,currenDate=currentMonth+"/"+currentDate.getDate()+"/"+currentDate.getFullYear();
jQuery(document).ready(function(){$(".datepicker").datetimepicker();setTimeout("loadReleaseGrid();",1);loadShipingGrid();$("#OriJobNumber").css("display","none");""!==$("#quoteNumber").val()&&$("#OriJobNumber").show();$("#datedID").val(currenDate);$("#postDateID").css("display","none");"Booked"===getUrlVars().jobStatus&&$(".customerNameField").attr("disabled",!0);$("#loadingPODiv").css({visibility:"hidden"});loadCustomerInvoice(null);loadVendorInvoice(null);estimatedamountRelease=$("#contractAmount_release").val();
""!==estimatedamountRelease&&null!==estimatedamountRelease&&($("#estimate").empty(),estimatedamountRelease=estimatedamountRelease.replace(/[^0-9\.]+/g,""),$("#estimate").text(formatCurrency(estimatedamountRelease)));$("#ReleasesID").datepicker({showOn:"button",buttonImage:"./../resources/web-plugins/jqueryui/jquery-ui-1.8.23.custom/development-bundle/demos/datepicker/images/calendar.gif",buttonImageOnly:!0});var a=$("#allocate").val(),a=estimatedamountRelease-a;$("#unAllocated").html(formatCurrency(a))});
function openvendorinvoicedialog(){if("0"===jQuery("#release").getGridParam("records"))return jQuery(newDialogDiv).html('<span><b style="color:red;">Please add one release in "Release Grid".</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var a=$("#shiping"),c=a.jqGrid("getGridParam","selrow"),b=a.jqGrid("getCell",c,"joReleaseDetailid"),f=a.jqGrid("getCell",c,"vePoId"),
a=a.jqGrid("getCell",c,"vendorDate");0!==jQuery("#shiping").getGridParam("records")?""!==a?(getVendorDetails(b,f),$("#postDateID").val(""),$("#postDateID").val(currenDate),$("#dueDateID").val(""),$("#dueDateID").val(currenDate),$("#shipDateID").val(""),$("#shipDateID").val(currenDate),$("#vendorDateID").val(""),$("#vendorDateID").val(currenDate),$("#openvendorinvoice").dialog("option","title",""),$("#openvendorinvoice").dialog("option","title",a),jQuery("#openvendorinvoice").dialog("open")):(errorText=
"Invoice not found, do you wish to create a new vendor invoice for this release?",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Information.",buttons:{Yes:function(){jQuery(this).dialog("close");getVendorDetails(b,f);$("#postDateID").val("");$("#postDateID").val(currenDate);$("#dueDateID").val("");$("#dueDateID").val(currenDate);$("#shipDateID").val("");$("#shipDateID").val(currenDate);
$("#vendorDateID").val("");$("#vendorDateID").val(currenDate);$("#openvendorinvoice").dialog("option","title","");$("#openvendorinvoice").dialog("option","title","New Vendor Invoice");jQuery("#openvendorinvoice").dialog("open")},No:function(){jQuery(this).dialog("close")}}}).dialog("open")):(errorText="Invoice not found, do you wish to create a new vendor invoice for this release?",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),
jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Information.",buttons:{Yes:function(){jQuery(this).dialog("close");getVendorDetails(b,f);$("#postDateID").val("");$("#postDateID").val(currenDate);$("#dueDateID").val("");$("#dueDateID").val(currenDate);$("#shipDateID").val("");$("#shipDateID").val(currenDate);$("#vendorDateID").val("");$("#vendorDateID").val(currenDate);$("#openvendorinvoice").dialog("option","title","");$("#openvendorinvoice").dialog("option","title","New Vendor Invoice");
jQuery("#openvendorinvoice").dialog("open")},No:function(){jQuery(this).dialog("close")}}}).dialog("open"));return!0}function cancelvendorInvoice(){$("#release").trigger("reloadGrid");jQuery("#openvendorinvoice").dialog("close");return!1}function customCurrencyFormatter(a,c,b){return formatCurrency(a)}jQuery(function(){jQuery("#openvendorinvoice").dialog({autoOpen:!1,width:850,modal:!0,close:function(){$("#release").trigger("reloadGrid");return!0}})});
function loadReleaseGrid(){release_grid(arrColNamesRelease,arrColModelRelease);return!0}
var arrColNamesRelease=" ; ;ReleaseId;Released;Type;ManufacturerId;rxMasterId;Manufacturer;Note;Allocated;JoDetailedID;VePOID;Bill Note;Web Sight;PONumber;ShipTo;rxContact;Email Time;BillToAdd;ShipToAdd;AddressID;CustomerPONumber;POID".split(";"),arrColModelRelease=[{name:"ponumber",index:"ponumber",align:"center",width:8,editable:!1,hidden:!1,formatter:alphabetSeq},{name:"billNoteImage",index:"billNoteImage",align:"right",width:8,editable:!1,hidden:!0,formatter:billImage},{name:"joReleaseId",index:"joReleaseId",
align:"left",width:30,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"released",index:"released",align:"center",width:20,editable:!0,hidden:!1,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"type",index:"type",align:"center",width:30,editable:!0,hidden:!1,edittype:"select",formatter:typeFormatter,editoptions:{value:{1:"Drop Ship",2:"Stock Order",3:"Bill Only",4:"Commission",5:"Service"}}},
{name:"manufacturerId",index:"manufacturerId",align:"left",width:20,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"rxMasterId",index:"rxMasterId",align:"left",width:30,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"manufacturer",index:"manufacturer",align:"left",width:90,editable:!0,hidden:!1,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,
required:!1}},{name:"note",index:"note",align:"left",width:30,editable:!0,hidden:!1,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"estimatedBilling",index:"estimatedBilling",align:"right",width:30,editable:!0,hidden:!1,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1},formatter:customCurrencyFormatter},{name:"joReleaseDetailid",index:"joReleaseDetailid",align:"left",width:30,editable:!0,hidden:!0,edittype:"text",
editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"vePoId",index:"vePoId",align:"left",width:20,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"billNote",index:"billNote",align:"left",width:20,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"webSight",index:"webSight",align:"left",width:20,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,
readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"ponumber",index:"ponumber",align:"left",width:20,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"shipToMode",index:"shipToMode",align:"left",width:30,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"rxVendorContactID",index:"rxVendorContactID",align:"left",width:30,editable:!0,hidden:!0,edittype:"text",
editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"emailTimeStamp",index:"emailTimeStamp",align:"left",width:30,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"billToAddressID",index:"billToAddressID",align:"left",width:30,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"shipToAddressID",index:"shipToAddressID",align:"left",width:30,
editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"rxAddressID",index:"rxAddressID",align:"left",width:30,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"customerPONumber",index:"customerPONumber",align:"left",width:30,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}},{name:"poid",index:"poid",align:"left",
width:30,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30,readonly:!0},editrules:{edithidden:!1,required:!1}}],colName_poAmount="PO Amount",colModel_poAmount={name:"po",index:"po",align:"right",width:30,formatter:customCurrencyFormatter},colName_InvoiceAmount="Invoice Amount",colModel_InvoiceAmount={name:"invoiceAmount",index:"invoiceAmount",align:"right",width:30,formatter:customCurrencyFormatter};
function checkPoAmount(){for(var a=document.getElementsByClassName("PoCheck"),c=0;c<a.length;c++){var b=a[c];"checkbox"===b.type&&b.checked?"Released"==b.value||"Type"==b.value||"Manufacturer"==b.value||"Note"==b.value||"Allocated"==b.value||isExistInArray(arrColNamesRelease,b.value)||"poAmount"!==b.value||isExistInArray(arrColNamesRelease,"poAmount")||(arrColNamesRelease.push(colName_poAmount),arrColModelRelease.push(colModel_poAmount)):"checkbox"!==b.type||b.checked||"poAmount"!==b.value||(removeA(arrColNamesRelease,
colName_poAmount),removeA(arrColModelRelease,colModel_poAmount))}$("#release").jqGrid("GridUnload");release_grid(arrColNamesRelease,arrColModelRelease);$("#release").trigger("reloadGrid");return!0}
function checkInvoAmount(){for(var a=document.getElementsByClassName("InvoCheck"),c=0;c<a.length;c++){var b=a[c];"checkbox"===b.type&&b.checked?"Released"==b.value||"Type"==b.value||"Manufacturer"==b.value||"Note"==b.value||"Allocated"==b.value||isExistInArray(arrColNamesRelease,b.value)||"invoiceAmount"!==b.value||isExistInArray(arrColNamesRelease,"invoiceAmount")||(arrColNamesRelease.push(colName_InvoiceAmount),arrColModelRelease.push(colModel_InvoiceAmount)):"checkbox"!==b.type||b.checked||"invoiceAmount"!==
b.value||(removeA(arrColNamesRelease,colName_InvoiceAmount),removeA(arrColModelRelease,colModel_InvoiceAmount))}$("#release").jqGrid("GridUnload");release_grid(arrColNamesRelease,arrColModelRelease);$("#release").trigger("reloadGrid");return!0}function alphabetSeq(a,c,b){c="";if(null!==a)for(alert(a),b=[],b=a.split("-"),a=b[1].match(/[A-z]/g),b=0;b<a.length;b++)c+=a[b];return c}
function billImage(a,c,b){return""!==a&&null!==a?"<img src='./../resources/Icons/dollar.png' style='vertical-align: middle;'>":""}
var release_grid=function(a,c){$("#release").jqGrid({url:"./jobtabs5/release",datatype:"JSON",mtype:"GET",colNames:a,colModel:c,rowNum:0,pgbuttons:!1,recordtext:"",rowList:[],pgtext:null,viewrecords:!1,sortname:"Name",sortorder:"asc",imgpath:"themes/basic/images",height:240,width:1080,altRows:!0,altclass:"myAltRowClass",postData:{jobNumber:function(){return $("#jobNumber_ID").text()}},loadComplete:function(b){$("#release").setSelection(1,!0);b=$("#release");var c=b.jqGrid("getGridParam","selrow");
b=b.jqGrid("getCell",c,"poid");!1===isNaN(b)?$("#PONumberID option[value="+b+"]").attr("selected",!0):$("#PONumberID option[value=-1]").attr("selected",!0);billAmountCal();b=$("#allocate").text();$("#unAllocated").text().replace(/[^0-9\.]+/g,"");b.replace(/[^0-9\.]+/g,"")},loadError:function(b,c,a){},jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"},onSelectRow:function(b){var c=jQuery(this).getRowData(b);b=c.joReleaseDetailid;
var a=c.rxMasterId,e=c.manufacturer,g=c.ponumber,h=c.customerPONumber,m=c.poid,k=c.vePoId,c=c.shipToMode;$("#shiping").jqGrid("GridUnload");loadShipingGrid(b);$("#shiping").jqGrid("setGridParam",{postData:{jobNumber:function(){return $("#jobNumber_ID").text()},joDetailsID:b}});$("#shiping").trigger("reloadGrid");$("#manufacture_ID").text(a);$("#vendorinvoice1").jqGrid("GridUnload");loadVendorInvoice(k);$("#vendorinvoice1").jqGrid("setGridParam",{postData:{vePoId:function(){return k}}});$("#vendorinvoice1").trigger("reloadGrid");
$("#customerInvoice_lineitems").jqGrid("GridUnload");loadCustomerInvoice(k);$("#customerInvoice_lineitems").jqGrid("setGridParam",{postData:{vePoId:function(){return k}}});$("#customerInvoice_lineitems").trigger("reloadGrid");$("#manufacurterNameID").val(e);$("#poNumberID").val("");$("#poNumberID").val(g);0==c?($("#shipTo").show(),$("#shipTo1").hide()):($("#shipTo1").show(),$("#shipTo").hide());getVendorDetails(b,k);getCustomerInvoiceDetails(b,a);$("#customerPONumberID").val("");$("#customerPONumberID").val(h);
!1===isNaN(m)?$("#PONumberID option[value="+m+"]").attr("selected",!0):$("#PONumberID option[value=-1]").attr("selected",!0)},ondblClickRow:function(b){editreleasedialog()}})};
function loadShipingGrid(a){$("#shiping").jqGrid({url:"./jobtabs5/shipping",datatype:"JSON",mtype:"GET",colNames:"Ship Date;Shipping Line ;Vendor Date;Vendor Invoice;Vendor Amount ($);Customer Date;Customer Amount ($);ShipID;JoReleaseID;VeBillID;CoAccID;CuInvoiceID".split(";"),colModel:[{name:"shipDate",index:"shipDate",align:"center",width:50},{name:"shippingLine",index:"shippingLine",align:"center",width:50},{name:"vendorDate",index:"vendorDate",align:"center",width:60},{name:"vendorInvoice",index:"vendorInvoice",
align:"center",width:50},{name:"vendorAmount",index:"vendorAmount",align:"right",width:60,formatter:customCurrencyFormatter},{name:"customerDate",index:"customerDate",align:"center",width:70},{name:"customerAmount",index:"customerAmount",align:"right",width:60,formatter:customCurrencyFormatter},{name:"veShipViaID",index:"veShipViaID",align:"right",width:60,hidden:!0},{name:"joReleaseDetailID",index:"veShipViaID",align:"right",width:60,hidden:!0},{name:"veBillID",index:"veBillID",align:"right",width:60,
hidden:!0},{name:"coAccountID",index:"coAccountID",align:"right",width:60,hidden:!0},{name:"cuInvoiceID",index:"cuInvoiceID",align:"right",width:60,hidden:!0}],rowNum:1E3,pgbuttons:!1,recordtext:"",rowList:[],pgtext:null,viewrecords:!1,sortname:"Name",sortorder:"asc",imgpath:"themes/basic/images",caption:!1,height:86,width:1080,altRows:!0,altclass:"myAltRowClass",loadComplete:function(c){$("#shiping").setSelection(1,!0)},loadError:function(c,b,a){},postData:{jobNumber:function(){return $("#jobNumber_ID").text()},
joDetailsID:a},jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"},onSelectRow:function(c){}})}
function addShipDetails(){var a=new Date,c=a.getDate(),b=a.getMonth()+1,f=a.getFullYear();0===jQuery("#shiping").getGridParam("records")?(jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">Invoice not found, do you wish to create a new vendor invoice for this release?</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Information.",buttons:{Yes:function(){jQuery(this).dialog("close");$("#vendorDateID").val("");$("#vendorDateID").val(b+
"/"+c+"/"+f);document.getElementById("datedID").disabled=!1;$("#datedID").val("");$("#datedID").val(b+"/"+c+"/"+f);$("#dueDateID").val("");$("#shipDateID").val("");$("#shipDateID").val(b+"/"+c+"/"+f);$("#postDateID").val("");$("#openvendorinvoice").dialog("option","title","");$("#openvendorinvoice").dialog("option","title","New Vendor Invoice");jQuery("#openvendorinvoice").dialog("open")},No:function(){jQuery(this).dialog("close")}}}).dialog("open")):($("#vendorDateID").val(""),$("#vendorDateID").val(b+
"/"+c+"/"+f),document.getElementById("datedID").disabled=!1,$("#datedID").val(""),$("#datedID").val(b+"/"+c+"/"+f),$("#dueDateID").val(""),$("#shipDateID").val(""),$("#shipDateID").val(b+"/"+c+"/"+f),$("#postDateID").val(""),$("#openvendorinvoice").dialog("option","title",""),$("#openvendorinvoice").dialog("option","title","New Vendor Invoice"),jQuery("#openvendorinvoice").dialog("open"));return!0}
function deleteShipDetails(){var a=$("#shiping"),c=a.jqGrid("getGridParam","selrow");if(null!==c)return jQuery(newDialogDiv).html('<span><b style="color: red;">Delete the Shipping Record?</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:120,title:"Confirm Delete",buttons:{Submit:function(){var b=a.jqGrid("getCell",c,"veShipViaID"),f=a.jqGrid("getCell",c,"joReleaseDetailID"),d=a.jqGrid("getCell",c,"cuInvoiceID"),e=a.jqGrid("getCell",c,"veBillID");deleteShip(b,f,e,d);jQuery(this).dialog("close");
$("#release").trigger("reloadGrid")},Cancel:function(){jQuery(this).dialog("close")}}}).dialog("open"),!0;jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color:red;">Please click one of the Shipping record to Delete.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!1}
function deleteShip(a,c,b,f){$.ajax({url:"./jobtabs5/deleteShipDetails",type:"GET",data:{shipDetailsID:a,releaseID:c,billID:b,cuInvoiceID:f},success:function(b){jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color: green;">Shipping record deleted successfully.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close");$("#shiping").trigger("reloadGrid")}}]}).dialog("open")}})}
function changeBillingDetails(){!1===$("#billing").is(":checked")?billAmountCalUnchk():billAmountCal()}
function billAmountCal(){$("#release").jqGrid("getGridParam","userData");var a=$("#release").jqGrid("getRowData"),c=$("#allocate").text();$("#unAllocated").text().replace(/[^0-9\.]+/g,"");var b=0;$.each(a,function(c,a){b=Number(b)+Number(a.estimatedBilling.replace(/[^0-9\.]+/g,""))});""!==estimatedamountRelease&&null!==estimatedamountRelease&&(estimatedamountRelease=estimatedamountRelease.replace(/[^0-9\.]+/g,""),$("#estimated").text(formatCurrency(estimatedamountRelease)),$("#allocate").empty(),
$("#allocate").text(formatCurrency(b)));c.replace(/[^0-9\.]+/g,"")}
function billAmountCalUnchk(){$("#release").jqGrid("getGridParam","userData");var a=$("#release").jqGrid("getRowData"),c=0;$.each(a,function(b,a){c=Number(c)+Number(a.estimatedBilling.replace(/[^0-9\.]+/g,""))});if($("#estimatedCost").val()<c)return jQuery(newDialogDiv).html('<span><b style="color:Green;">Allocated billing exceeds contract amount.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Success",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close");
$("#estimated").empty();$("#allocate").empty();$("#estimated").text(formatCurrency(c));$("#allocate").text(formatCurrency(c))}}]}).dialog("open"),!1;$("#estimated").empty();$("#allocate").empty();a=$("#estimatedCost").val();a=a.replace(/[^0-9\.]+/g,"");$("#estimated").text(formatCurrency(a));$("#allocate").text(formatCurrency(c));return!0}
function typeFormatter(a,c,b){if(null===a||-1===a)return"";if(1===a)return"Drop Ship";if(2===a)return"Stock Order";if(3===a)return"Bill Only";if(4===a)return"Commission";if(5===a)return"Service"}function isExistInArray(a,c){return-1===jQuery.inArray(c,a)?!1:!0}function removeA(a){for(var c,b=arguments,f=b.length,d;1<f&&a.length;)for(c=b[--f];-1!=(d=a.indexOf(c));)a.splice(d,1);return a}
jQuery(function(){jQuery("#openReleaseDig").dialog({autoOpen:!1,width:400,title:"Add/Edit Release",modal:!0,buttons:{},closeOnEscape:!1,close:function(){$("#openReleaseDigForm").validationEngine("hideAll");return!0}})});
function addRelease(){if("Booked"===getUrlVars().jobStatus){if(0===$("#release").getGridParam("reccount")&&!validateNewRelease())return jQuery(newDialogDiv).html('<span><b style="color:red;">Credit approval required.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:30,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1}else return errorText="Please change the status to 'Booked'.",jQuery(newDialogDiv).attr("id","msgDlg"),
jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;aReleaseDialogVar="add";document.getElementById("openReleaseDigForm").reset();var a=$("#poAmountID").is(":checked"),c=$("#invoiceAmountID").is(":checked");!0===a?$("#poAmountFieldID").show():$("#poAmountFieldID").css("display","none");!0===c?$("#invoiceAmountFieldID").show():
$("#invoiceAmountFieldID").css("display","none");var b=new Date,a=b.getDate(),c=b.getMonth()+1,b=b.getFullYear(),a=c+"/"+a+"/"+b;$("#ReleasesID").val(a);""!==$("#customerpodetails").val()?$("#customerPONumberSelectID option[value=1]").attr("selected",!0):$("#customerPONumberSelectID option[value=-1]").attr("selected",!0);jQuery("#openReleaseDig").dialog("open");return!0}
function validateNewRelease(){var a=!1,c=$("#joMaster_ID").text(),b=$("#jobNumber_ID").text();$.ajax({async:!1,url:"./jobtabs5/validatefirstrelease",type:"GET",data:"&joMasterID="+c+"&jobNumber="+b,success:function(b){a=b;return!0}});return a}
$(function(){var a={},c="";$("#ReleasesManuID").autocomplete({minLength:2,select:function(b,c){var a=c.item.id;$("#ManufacturerId").val(a)},source:function(b,f){var d=b.term;d in a?f(a[d]):c=$.getJSON("jobtabs2/vendorsList",b,function(b,g,h){a[d]=b;h===c&&f(b)})},error:function(b){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
function saveRelease(){if(!$("#openReleaseDigForm").validationEngine("validate"))return!1;var a=$("#openReleaseDigForm").serialize(),c=$("#joMaster_ID").text(),b=$("#jobNumber_ID").text(),f=$("#rxCustomer_ID").text();if(""===$("#ManufacturerId").val())return $("#message1").html('<span style="color:red;">Alert: Please provide a valid Manufacturer.</span>'),$("#message1").show().delay(4E3).fadeOut(),!1;a=a+"&joMasterID="+c+"&oper="+aReleaseDialogVar+"&jobNumber="+b+"&rxMasterID="+f;console.log(b);console.log(a);
$.ajax({url:"./jobtabs5/addRelease",type:"POST",data:a,success:function(b){$("#openReleaseDigForm").validationEngine("hideAll");jQuery("#openReleaseDig").dialog("close");$("#release").trigger("reloadGrid");"add"===aReleaseDialogVar?$("#releaseMessage").html('<span style="color:green;">Success: Release Details Added Sucessfully</span>'):$("#releaseMessage").html('<span style="color:green;">Success: Release Details Updated Sucessfully</span>');$("#releaseMessage").show().delay(5E3).fadeOut()}});return!0}
function editRelease(){if("Booked"===getUrlVars().jobStatus){aReleaseDialogVar="edit";var a=$("#release"),c=a.jqGrid("getGridParam","selrow");if(null===c){var b="Please select the Release from the Grid to Edit.";jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color:red;">'+b+"</b></span>");jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!1}}else return b=
"Please change the status to 'Booked'.",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+b+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var b=a.jqGrid("getCell",c,"vePoId"),f=a.jqGrid("getCell",c,"joReleaseId"),d=a.jqGrid("getCell",c,"released"),e=a.jqGrid("getCell",c,"type");"Drop Ship"===e?e=1:"Stock Order"===
e?e=2:"Bill Only"===e?e=3:"Commission"===e?e=4:"Service"===e&&(e=5);console.log(c);var g=a.jqGrid("getCell",c,"rxMasterId"),h=a.jqGrid("getCell",c,"manufacturerId"),m=a.jqGrid("getCell",c,"manufacturer"),k=a.jqGrid("getCell",c,"note"),l=a.jqGrid("getCell",c,"estimatedBilling"),n=a.jqGrid("getCell",c,"joReleaseDetailid"),p=a.jqGrid("getCell",c,"po"),q=a.jqGrid("getCell",c,"invoiceAmount"),a=a.jqGrid("getCell",c,"poid"),l=l.replace(/[^0-9\.]+/g,""),l=Number(l),r=$("#poAmountID").is(":checked"),c=$("#invoiceAmountID").is(":checked");
!0===r?($("#poAmountFieldID").show(),p=p.replace(/[^0-9\.]+/g,""),p=Number(p),$("#POAmountID").val(p)):$("#poAmountFieldID").css("display","none");!0===c?($("#invoiceAmountFieldID").show(),q=q.replace(/[^0-9\.]+/g,""),q=Number(q),$("#ReleasesInvoiceID").val(q)):$("#invoiceAmountFieldID").css("display","none");$("#vePoId").val(b);$("#ReleasesID").val(d);$("#ReleasesTypeID").val(e);$("#ManufacturerId").val(g);$("#ReleasesManuID").val(m);$("#NoteID").val(k);$("#AllocatedID").val(l);$("#joReleaseDetailId").val(n);
$("#joReleaseId").val(f);$("#veFactoryId").val(h);$("#customerPONumberSelectID option[value="+a+"]").attr("selected",!0);jQuery("#openReleaseDig").dialog("open");return!0}
function deleteRelease(){aReleaseDialogVar="del";var a=$("#release").jqGrid("getGridParam","selrow"),c=jQuery(document.createElement("div"));if(null===a)return jQuery(c).attr("id","msgDlg"),jQuery(c).html('<span><b style="color:red;">Please select the Release from the Grid to Delete.</b></span>'),jQuery(c).dialog({modal:!0,width:400,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;jQuery(c).html('<span><b style="color: red;">Do You Want to Delete the Release Record?</b></span>');
jQuery(c).dialog({modal:!0,width:400,height:150,title:"Confirm Delete",buttons:{Delete:function(){var b=$("#release"),c=b.jqGrid("getGridParam","selrow"),a=b.jqGrid("getCell",c,"vePoId"),e=b.jqGrid("getCell",c,"joReleaseId"),b=b.jqGrid("getCell",c,"joReleaseDetailid"),a="&vePoName="+a+"&joReleaseName="+e+"&joReleaseDetailName="+b+"&oper="+aReleaseDialogVar;jQuery(this).dialog("close");$.ajax({url:"./jobtabs5/addRelease",type:"POST",data:a,success:function(b){$("#releaseMessage").html('<span style="color:green;">Success: Releases Details Deleted Sucessfully</span>');
$("#releaseMessage").show().delay(5E3).fadeOut();$("#release").trigger("reloadGrid")}})},Cancel:function(){jQuery(this).dialog("close")}}}).dialog("open");return!0}function cancelRelease(){$("#openReleaseDigForm").validationEngine("hideAll");jQuery("#openReleaseDig").dialog("close");return!0}
function release_save(){var a=$("#releaseNote").val(),c=$("#joMaster_ID").text(),b=getUrlVars().jobName,f=getUrlVars().jobNumber,d=$("#bidDate_Date").val();$.ajax({url:"./jobtabs5/updateReleaseNote",type:"POST",data:"&joMasterID="+c+"&releaseNote="+a+"&jobName="+b+"&jobNumber="+f+"&joBidDate="+d,success:function(b){jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color:green;">Release Details Successfully Updated.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,
width:300,height:150,title:"Success",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!1}})}
function openBillDialog(){var a=$("#release"),c=a.jqGrid("getGridParam","selrow");if(null===c)return jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">Please select the Release from the Grid to Add/Edit Bill Note.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;a=a.jqGrid("getCell",c,"billNote");$("#billNote").val(a);jQuery("#openBillNoteDialog").dialog("open");
return!0}jQuery(function(){jQuery("#openBillNoteDialog").dialog({autoOpen:!1,width:340,title:"Bill Note",modal:!0,buttons:{},close:function(){return!0}})});
function saveBillNote(){var a=$("#billNote").val(),c=$("#release"),b=c.jqGrid("getGridParam","selrow"),f=c.jqGrid("getCell",b,"joReleaseId"),d=$("#joMaster_ID").text(),e=c.jqGrid("getCell",b,"released"),g=c.jqGrid("getCell",b,"type"),h=c.jqGrid("getCell",b,"note"),c=c.jqGrid("getCell",b,"estimatedBilling").replace(/[^0-9\.]+/g,"");$.ajax({url:"./jobtabs5/billNote",type:"GET",data:"&joReleaseId="+f+"&billNote="+a+"&joMasterID="+d+"&joReleaseDate="+e+"&joReleaseType="+g+"&ReleaseNote="+h+"&EstimatedBilling="+
Number(c),success:function(b){jQuery("#openBillNoteDialog").dialog("close");$("#release").trigger("reloadGrid");jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color:green;">Bill Note Successfully Updated.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Success",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!1}})}
function cancelBillNote(){jQuery("#openBillNoteDialog").dialog("close")}
function openReleaseTrack(){var a=$("#release"),c=a.jqGrid("getGridParam","selrow"),a=a.jqGrid("getCell",c,"webSight");null===a||""===a?(jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">Tracking Web Site is not there.</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Information",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open")):"http"===a.split(":")[0]?window.open(a):window.open("http://"+
a)}
function editreleasedialog(){var a=$("#rxCustomer_ID").text(),c=$("#release"),b=c.jqGrid("getGridParam","selrow"),f=!1;$.ajax({url:"./jobtabs3/getHoldCredit",type:"GET",data:{customerID:a},success:function(b){f=b.creditHold}});a=getUrlVars().jobStatus;if("Closed"===a||"Bid"===a||"Planning"===a||"Budget"===a||"Quote"===a||"Submitted"===a||"Closed"===a||"Lost"===a||"Abandoned"===a||"Rejected"===a||"Over Budget"===a)return errorText="Please change the status to 'Booked'.",jQuery(newDialogDiv).attr("id","msgDlg"),
jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;if("Booked"===a){if(!0===f)return errorText="This job is on Pending.  Approval required.",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,
width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close");document.location.href="./customerdetails?rolodexNumber="+$("#rxCustomer_ID").text()+"&name=`"+$("#jobCustomerName_ID").text()+"`&creditHold=false"}}]}).dialog("open"),!1;if(null===b)return errorText="Please click one of the Order to Edit Purchase Order.",jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,
title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var a=c.jqGrid("getCell",b,"rxMasterId"),d=c.jqGrid("getCell",b,"manufacturer"),e=c.jqGrid("getCell",b,"vePoId"),g=c.jqGrid("getCell",b,"rxAddressID"),c=c.jqGrid("getCell",b,"poid");$.ajax({url:"./jobtabs5/getAddressAddressInformation",mType:"GET",data:{rxAddressID:g},success:function(b){}});loadPORelease(a,e,d,c)}$("#lineItemGrid").trigger("reloadGrid");$("#Ack").trigger("reloadGrid");return!0}
function disableoption(a){$("#releasesTypeID").val(1);return!0}
function sendPOEmail(a){var c=$("#release"),b=c.jqGrid("getGridParam","selrow"),f=c.jqGrid("getCell",b,"vePoId"),d=c.jqGrid("getCell",b,"rxVendorContactID"),e="",g=$("#ourPoId").val();if(null===b)return e="Please click one of the Order to Email Purchase Order.",jQuery(newDialogDiv).html('<span><b style="color:red;">'+e+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),
!1;if(null===d&&""===d&&"-1"===d)return e="Please Add Contact for Purchase Order.",jQuery(newDialogDiv).html('<span><b style="color:red;">'+e+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;$.ajax({url:"./vendorscontroller/GetContactDetails",mType:"GET",data:{rxContactID:d},success:function(b){var c=b.email;b=b.firstName+" "+b.lastName;e=""===c?"Are you sure you want to send this PO to"+
b+"?":"Are you sure you want to send this PO to"+b+"("+c+")?";jQuery(newDialogDiv).html('<span><b style="color:green;">'+e+"</b></span>");jQuery(newDialogDiv).dialog({modal:!0,width:400,height:150,title:"Message",buttons:{Send:function(){$("#loadingPODiv").css({visibility:"visible"});viewPOPDF("purchase");sentMailPOFunction(d,c,a,g,f);jQuery(this).dialog("close")},Cancel:function(){jQuery(this).dialog("close")}}}).dialog("open")}});return!0}
function sentMailPOFunction(a,c,b,f,d){""===c?(jQuery(newDialogDiv).html('<form id="mailToAddress"><table><tr><td><span><b style="color:red;">Please Provide a Mail ID.</b></span></td></tr><tr><td style="height: 5px;"></td></tr><tr><td><label>Mail ID: </label><input type="text" id="mailToAddress_ID" name="mailToAddress_name" class="validate[custom[email]]" style="width: 250px;" /></td></tr></table></form><hr>'),jQuery(newDialogDiv).dialog({modal:!0,width:430,height:180,title:"Message",buttons:{"Submit & Send":function(){if(!$("#mailToAddress").validationEngine("validate"))return!1;
var b=$("#mailToAddress_ID").val();saveMailAddress(b,a);$("#loadingPODiv").css({visibility:"visible"});$.ajax({url:"./sendMailServer/sendPOMail",mType:"POST",data:{contactID:a,PONumber:f},success:function(b){$("#loadingPODiv").css({visibility:"hidden"});jQuery(newDialogDiv).html('<span><b style="color:green;">Mail Sent Successfully.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Message",buttons:[{height:35,text:"OK",click:function(){var b=new Date,c=b.getDate(),a=
b.getMonth()+1,f=b.getFullYear().toString().substr(2,2),e=b.getHours(),g=b.getMinutes(),q=12<=e?"PM":"AM",e=(e%=12)?e:12;10>c&&(c="0"+c);10>a&&(a="0"+a);10>e&&(e="0"+e);10>g&&(g="0"+g);b=a+"/"+c+"/"+f+" "+e+":"+g+" "+q;$.ajax({url:"./jobtabs3/updateEmailStampValue",mType:"GET",data:{vePOID:d,purcheaseDate:b},success:function(c){$("#emailTimeStamp").empty();$("#emailTimeStamp").append(b)}});$(this).dialog("close")}}]}).dialog("open")}});jQuery(this).dialog("close");return!0},Cancel:function(){jQuery(this).dialog("close")}}}).dialog("open")):
"poGeneral"===b?($("#loadingPOGenDiv").css({visibility:"visible"}),$.ajax({url:"./sendMailServer/sendPOMail",mType:"POST",data:{contactID:a,PONumber:f},success:function(b){$("#loadingPOGenDiv").css({visibility:"hidden"});$("#loadingPODiv").css({visibility:"hidden"});jQuery(newDialogDiv).html('<span><b style="color:green;">Mail Sent Successfully.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Message",buttons:[{height:35,text:"OK",click:function(){var b=new Date,c=b.getDate(),
a=b.getMonth()+1,f=b.getFullYear().toString().substr(2,2),e=b.getHours(),n=b.getMinutes(),p=12<=e?"PM":"AM",e=(e%=12)?e:12;10>c&&(c="0"+c);10>a&&(a="0"+a);10>e&&(e="0"+e);10>n&&(n="0"+n);b=a+"/"+c+"/"+f+" "+e+":"+n+" "+p;$.ajax({url:"./jobtabs3/updateEmailStampValue",mType:"GET",data:{vePOID:d,purcheaseDate:b},success:function(c){$("#emailTimeStamp").empty();$("#emailTimeStamp").append(b)}});$(this).dialog("close")}}]}).dialog("open")}})):$.ajax({url:"./sendMailServer/sendPOMail",mType:"POST",data:{contactID:a,
PONumber:f},success:function(b){$("#loadingPODiv").css({visibility:"hidden"});jQuery(newDialogDiv).html('<span><b style="color:green;">Mail Sent Successfully.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Message",buttons:[{height:35,text:"OK",click:function(){var b=new Date,c=b.getDate(),a=b.getMonth()+1,e=b.getFullYear().toString().substr(2,2),f=b.getHours(),n=b.getMinutes(),p=12<=f?"PM":"AM",f=(f%=12)?f:12;10>c&&(c="0"+c);10>a&&(a="0"+a);10>f&&(f="0"+f);10>n&&(n=
"0"+n);b=a+"/"+c+"/"+e+" "+f+":"+n+" "+p;$.ajax({url:"./jobtabs3/updateEmailStampValue",mType:"GET",data:{vePOID:d,purcheaseDate:b},success:function(c){$("#emailTimeStamp").empty();$("#emailTimeStamp").append(b)}});$(this).dialog("close")}}]}).dialog("open")}})}function saveMailAddress(a,c){$.ajax({url:"./jobtabs2/updateEmailAddress",mType:"GET",data:{email:a,contactID:c},success:function(b){}})}
function viewPOPDF(a){var c=$("#release"),b=c.jqGrid("getGridParam","selrow"),f=c.jqGrid("getCell",b,"vePoId"),d=c.jqGrid("getCell",b,"manufacturerId"),c=c.jqGrid("getCell",b,"shipToMode"),e=Number(c),g=$.trim($("#jobNumber_ID").text()),h=$("#rxCustomer_ID").text();if("purchase"===a)$.ajax({type:"GET",url:"./purchasePDFController/viewPDFLineItemForm",data:{vePOID:f,puchaseOrder:a,jobNumber:g,rxMasterID:h,manufacturerID:d,shipToAddrID:e},documenttype:"applicationpdf",async:!1,cache:!1,success:function(b){},
error:function(b){}});else{if(null===b)return errorText="Please click one of the Order to View Purchase Order.",jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;window.open("./purchasePDFController/viewPDFLineItemForm?vePOID="+f+"&puchaseOrder=Po&jobNumber="+g+"&rxMasterID="+h+"&manufacturerID="+d+
"&shipToAddrID="+c)}return!0}
function loadVendorInvoice(a){$("#vendorinvoice1").jqGrid({datatype:"JSON",mtype:"POST",pager:jQuery("#vendorinvoicepager"),url:"./jobtabs5/jobReleaseLineItem",postData:{vePoId:function(){return a}},colNames:"Product No;Description;Qty;Cost Ea;Mult.;Tax;Amount;VepoID;prMasterID;vePodetailID;Posiion;Move".split(";"),colModel:[{name:"note",index:"note",align:"left",width:70,editable:!0,hidden:!1,edittype:"text",editoptions:{size:40},editrules:{edithidden:!1,required:!0}},{name:"description",index:"description",
align:"left",width:130,editable:!0,hidden:!1,edittype:"text",editoptions:{size:40},editrules:{edithidden:!1},cellattr:function(c,b,a,d,e){return'style="white-space: normal" '}},{name:"quantityOrdered",index:"quantityOrdered",align:"center",width:15,hidden:!1,editable:!0,editoptions:{size:5,alignText:"left"},editrules:{edithidden:!0,required:!1}},{name:"unitCost",index:"unitCost",align:"right",width:50,hidden:!1,editable:!0,editoptions:{size:15,alignText:"right"},editrules:{edithidden:!0},formatter:customCurrencyFormatter},
{name:"priceMultiplier",index:"priceMultiplier",align:"right",width:50,hidden:!1,editable:!0,editoptions:{size:15,alignText:"right"},editrules:{edithidden:!0}},{name:"taxable",index:"taxable",align:"center",width:20,hidden:!1,editable:!0,formatter:"checkbox",edittype:"checkbox",editrules:{edithidden:!0}},{name:"quantityBilled",index:"quantityBilled",align:"right",width:50,hidden:!1,editable:!1,formatter:customCurrencyFormatter,editoptions:{size:15,alignText:"right"},editrules:{edithidden:!0}},{name:"vePoid",
index:"vePoid",align:"right",width:50,hidden:!0,editable:!0,editoptions:{size:15,alignText:"right"},editrules:{edithidden:!1,required:!1}},{name:"prMasterId",index:"prMasterId",align:"right",width:50,hidden:!0,editable:!0,editoptions:{size:15,alignText:"right"},editrules:{edithidden:!1,required:!1}},{name:"vePodetailId",index:"vePodetailId",align:"right",width:50,hidden:!0,editable:!0,editoptions:{size:15,alignText:"right"},editrules:{edithidden:!1,required:!1}},{name:"posistion",index:"posistion",
align:"left",width:70,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30},editrules:{edithidden:!1,required:!1}},{name:"upAndDown",index:"upAndDown",align:"left",width:40,hidden:!0}],rowNum:0,pgbuttons:!1,recordtext:"",rowList:[],pgtext:null,viewrecords:!1,sortname:"vePodetailId",sortorder:"asc",imgpath:"themes/basic/images",caption:!1,height:210,width:770,rownumbers:!0,altRows:!0,altclass:"myAltRowClass",caption:"Vendor Invoice",jsonReader:{root:"rows",page:"page",total:"total",records:"records",
repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"},loadComplete:function(c){$("#vendorinvoice1").setSelection(1,!0);var b=$("#vendorinvoice1").jqGrid("getRowData"),a=[],d=[],e=0,g=0;c=0;$.each(b,function(b,c){a[b]=c.quantityBilled;var d=a[b].replace(/[^0-9\.]+/g,"");e=Number(e)+Number(d)});$("#subtotal_ID").val(formatCurrency(e));var h=$("#tax_ID").val().replace(/[^0-9\.]+/g,"");$.each(b,function(b,c){a[b]=c.taxable;if("Yes"===a[b]){d[b]=c.quantityBilled;var e=d[b].replace(/[^0-9\.]+/g,"");g+=
Number(e)*(h/100)}});var b=$("#freight_ID").val(),m="";""!==b&&(m=b.replace(/[^0-9\.]+/g,""));c=c+e+g+Number(m);$("#total_ID").val(formatCurrency(c));$("#vendorinvoice1").trigger("reload")},loadError:function(c,b,a){},editurl:"./jobtabs5/manpulaterPOReleaseLineItem"}).navGrid("#vendorinvoicepager",{add:!0,edit:!0,del:!0,refresh:!0,search:!1},{width:450,left:400,top:300,closeAfterEdit:!0,reloadAfterSubmit:!0,modal:!0,jqModel:!0,editCaption:"Edit Product",beforeShowForm:function(c){jQuery("#TblGrid_vendorinvoice1 #tr_note .CaptionTD").empty();
jQuery("#TblGrid_vendorinvoice1 #tr_note .CaptionTD").append("Product No: ");jQuery("#TblGrid_vendorinvoice1 #tr_note .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_vendorinvoice1 #tr_description .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_description .CaptionTD").append("Description: ");jQuery("#TblGrid_vendorinvoice1 #tr_quantityOrdered .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_quantityOrdered .CaptionTD").append("Qty: ");
jQuery("#TblGrid_vendorinvoice1 #tr_quantityOrdered .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_vendorinvoice1 #tr_unitCost .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_unitCost .CaptionTD").append("Cost Each.: ");jQuery("#TblGrid_vendorinvoice1 #tr_priceMultiplier .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_priceMultiplier .CaptionTD").append("Mult.: ");jQuery("#TblGrid_vendorinvoice1 #tr_priceMultiplier .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');
jQuery("#TblGrid_vendorinvoice1 #tr_taxable .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_taxable .CaptionTD").append("Tax: ");$(function(){var b={},c="";$("#note").autocomplete({minLength:1,timeout:1E3,select:function(b,c){var a=c.item.id,f=c.item.label;$("#prMasterId").val(a);-1!==f.indexOf("-")&&(a=f.split("-")[1].split("]")[0].split("["),$("#description").val(a[1]))},source:function(a,e){var g=a.term;g in b?e(b[g]):c=$.getJSON("jobtabs3/productCodeWithNameList",a,function(a,d,k){b[g]=
a;k===c&&e(a)})},error:function(b){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});return!0},afterSubmit:function(c,b){return[!0,loadVendorInvoice(a)]}},{width:515,left:400,top:300,closeAfterAdd:!0,reloadAfterSubmit:!0,modal:!0,jqModel:!0,addCaption:"Add Product",beforeShowForm:function(c){if(""===a)return errorText="Please add 'Purchase Order'",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,
width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),jQuery(".ui-icon-closethick").trigger("click"),!1;jQuery("#TblGrid_vendorinvoice1 #tr_note .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_note .CaptionTD").append("Product No: ");jQuery("#TblGrid_vendorinvoice1 #tr_note .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_vendorinvoice1 #tr_description .CaptionTD").empty();
jQuery("#TblGrid_vendorinvoice1 #tr_description .CaptionTD").append("Description: ");jQuery("#TblGrid_vendorinvoice1 #tr_quantityOrdered .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_quantityOrdered .CaptionTD").append("Qty: ");jQuery("#TblGrid_vendorinvoice1 #tr_quantityOrdered .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_vendorinvoice1 #tr_unitCost .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_unitCost .CaptionTD").append("Cost Each: ");
jQuery("#TblGrid_vendorinvoice1 #tr_priceMultiplier .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_priceMultiplier .CaptionTD").append("Multiplier: ");jQuery("#TblGrid_vendorinvoice1 #tr_priceMultiplier .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_vendorinvoice1 #tr_taxable .CaptionTD").empty();jQuery("#TblGrid_vendorinvoice1 #tr_taxable .CaptionTD").append("Tax: ");$(function(){var b={},c="";$("#note").autocomplete({minLength:1,timeout:1E3,
select:function(b,c){var a=c.item.id,f=c.item.label;$("#prMasterId").val(a);-1!==f.indexOf("-")&&(a=f.split("-")[1].split("]")[0].split("["),$("#description").val(a[1]))},source:function(a,e){var g=a.term;g in b?e(b[g]):c=$.getJSON("jobtabs3/productCodeWithNameList",a,function(a,d,k){b[g]=a;k===c&&e(a)})},error:function(b){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});return!0},onclickSubmit:function(c){return{vePoid:a}},afterSubmit:function(c,b){return[!0,loadVendorInvoice(a)]}},
{closeOnEscape:!0,reloadAfterSubmit:!0,modal:!0,jqModal:!0,width:300,left:450,top:350,caption:"Delete Product",msg:"Delete the Product Record?",onclickSubmit:function(c){c=jQuery("#vendorinvoice1").jqGrid("getGridParam","selrow");return{vePodetailId:jQuery("#vendorinvoice1").getCell(c,10)}}},{})}
function viewInvoiceDetails(){var a=$("#vendorinvoice1"),c=a.jqGrid("getGridParam","selrow"),b=a.jqGrid("getCell",c,"prMasterId"),a=a.jqGrid("getCell",c,"note");document.location.href="./inventoryDetails?token=view&inventoryId="+b+"&itemCode="+a+"";return!0}
function getVendorDetails(a,c){$.ajax({url:"./jobtabs5/getVendorInvoiceDetails",type:"POST",data:{releaseDetailID:a,vePODetailId:c},success:function(b){if(""!==b){var c=new Date(b.postDate),a=new Date(b.dueDate),e=new Date(b.shipDate),g=new Date(b.receiveDate),c=c.getUTCMonth()+1+"/"+c.getUTCDate()+"/"+c.getUTCFullYear(),a=a.getUTCMonth()+1+"/"+a.getUTCDate()+"/"+a.getUTCFullYear(),e=e.getUTCMonth()+1+"/"+e.getUTCDate()+"/"+e.getUTCFullYear(),g=g.getUTCMonth()+1+"/"+g.getUTCDate()+"/"+g.getUTCFullYear();
document.getElementById("datedID").disabled=!0;$("#postDateID").val("");$("#proNumberID").val(b.trackingNumber);$("#postDateID").val("");$("#postDateID").val(c);$("#dueDateID").val("");$("#dueDateID").val(a);$("#shipDateID").val("");$("#shipDateID").val(e);$("#vendorDateID").val("");$("#vendorDateID").val(g);$("#freight_ID").val(formatCurrency(b.freightAmount));$("#tax_ID").val(formatCurrency(b.taxAmount));$("#bal_ID").val("$0.00");$("#vendorInvoiceNum").val(b.invoiceNumber);$("#veBill_ID").val(b.veBillId);
$("#coAccountID option[value="+b.apaccountId+"]").attr("selected",!0);$("#shipViaSelectID option[value="+b.veShipViaId+"]").attr("selected",!0);!0===b.usePostDate&&($("#postDateChkID").prop("checked",!0),$("#postDateID").show())}}});return!0}function postDateChk(){$("#postDateChkID").is(":checked")?$("#postDateID").show():$("#postDateID").hide()}
function savevendorinvoice(){var a=$("#openvendorinvoiceFormID").serialize(),c=$("#subtotal_ID").val().replace(/[^0-9\.]+/g,""),b=$("#freight_ID").val().replace(/[^0-9\.]+/g,""),f=$("#tax_ID").val().replace(/[^0-9\.]+/g,""),d=$("#total_ID").val().replace(/[^0-9\.]+/g,""),e=$("#bal_ID").val().replace(/[^0-9\.]+/g,""),g=$("#openvendorinvoice").dialog("option","title"),h=$("#shiping"),m=h.jqGrid("getGridParam","selrow"),k=$("#release"),l=k.jqGrid("getGridParam","selrow"),n="",p=k.jqGrid("getCell",l,
"joReleaseDetailid"),q=k.jqGrid("getCell",l,"vePoId"),k=k.jqGrid("getCell",l,"rxMasterId"),l="";"New Vendor Invoice"===g?l="add":(n=h.jqGrid("getCell",m,"veBillID"),l="edit");$.ajax({url:"./jobtabs5/updateVendorInvoiceDetails",type:"POST",data:a+"&subtotal_Name="+c+"&freight_Name="+b+"&tax_Name="+f+"&total_Name="+d+"&bal_Name="+e+"&oper="+l+"&joReleaseDetailsID="+p+"&veBill_Name="+n+"&vePOID="+q+"&rxMasterID="+k,success:function(b){jQuery(newDialogDiv).html('<span><b style="color:Green;">Vendor Invoice Details Updated.</b></span>');
jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Success.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close");jQuery("#openvendorinvoice").dialog("close");$("#release").trigger("reloadGrid")}}]}).dialog("open")}})}
function loadCustomerInvoice(a){$("#cusinvoicetab").tabs();$("#customerInvoice_lineitems").jqGrid({datatype:"JSON",mtype:"POST",pager:jQuery("#customerInvoice_lineitemspager"),url:"./jobtabs5/jobReleaseLineItem",postData:{vePoId:function(){return a}},colNames:"Product No;Description;Qty;Cost Ea;Mult.;Tax;Amount;VepoID;prMasterID;vePodetailID;Posiion;Move".split(";"),colModel:[{name:"note",index:"note",align:"left",width:70,editable:!0,hidden:!1,edittype:"text",editoptions:{size:40},editrules:{edithidden:!1,
required:!0}},{name:"description",index:"description",align:"left",width:130,editable:!0,hidden:!1,edittype:"text",editoptions:{size:40},editrules:{edithidden:!1},cellattr:function(c,b,a,d,e){return'style="white-space: normal" '}},{name:"quantityOrdered",index:"quantityOrdered",align:"center",width:15,hidden:!1,editable:!0,editoptions:{size:5,alignText:"left"},editrules:{edithidden:!0,required:!1}},{name:"unitCost",index:"unitCost",align:"right",width:50,hidden:!1,editable:!0,editoptions:{size:15,
alignText:"right"},editrules:{edithidden:!0},formatter:customCurrencyFormatter},{name:"priceMultiplier",index:"priceMultiplier",align:"right",width:50,hidden:!1,editable:!0,editoptions:{size:15,alignText:"right"},editrules:{edithidden:!0}},{name:"taxable",index:"taxable",align:"center",width:20,hidden:!1,editable:!0,formatter:"checkbox",edittype:"checkbox",editrules:{edithidden:!0}},{name:"quantityBilled",index:"quantityBilled",align:"right",width:50,hidden:!1,editable:!1,formatter:customCurrencyFormatter,
editoptions:{size:15,alignText:"right"},editrules:{edithidden:!0}},{name:"vePoid",index:"vePoid",align:"right",width:50,hidden:!0,editable:!0,editoptions:{size:15,alignText:"right"},editrules:{edithidden:!1,required:!1}},{name:"prMasterId",index:"prMasterId",align:"right",width:50,hidden:!0,editable:!0,editoptions:{size:15,alignText:"right"},editrules:{edithidden:!1,required:!1}},{name:"vePodetailId",index:"vePodetailId",align:"right",width:50,hidden:!0,editable:!0,editoptions:{size:15,alignText:"right"},
editrules:{edithidden:!1,required:!1}},{name:"posistion",index:"posistion",align:"left",width:70,editable:!0,hidden:!0,edittype:"text",editoptions:{size:30},editrules:{edithidden:!1,required:!1}},{name:"upAndDown",index:"upAndDown",align:"left",width:40,hidden:!0}],rowNum:0,pgbuttons:!1,recordtext:"",rowList:[],pgtext:null,viewrecords:!1,sortname:"vePodetailId",sortorder:"asc",imgpath:"themes/basic/images",caption:!1,height:210,width:770,rownumbers:!0,altRows:!0,altclass:"myAltRowClass",caption:"Customer Invoice",
jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"},loadComplete:function(c){var b=$("#customerInvoice_lineitems").jqGrid("getRowData"),a=[],d=[],e=0,g=0;c=0;$.each(b,function(b,c){a[b]=c.quantityBilled;var d=a[b].replace(/[^0-9\.]+/g,"");e=Number(e)+Number(d)});$("#customerInvoice_linesubTotalID").val(formatCurrency(e));$("#customerInvoice_subTotalID").val(formatCurrency(e));$.each(b,function(b,c){a[b]=c.taxable;if("Yes"===a[b]){d[b]=
c.quantityBilled;var e=d[b].replace(/[^0-9\.]+/g,""),l=$("#customerInvoice_linetaxId").val();g+=Number(e)*(l/100)}});b=$("#customerInvoice_linefrightID").val().replace(/[^0-9\.]+/g,"");c=c+e+g+Number(b);$("#customerInvoice_linetotalID").val(formatCurrency(c));$("#customerInvoice_totalID").val(formatCurrency(c))},loadError:function(c,b,a){},onSelectRow:function(c){},editurl:"./jobtabs5/manpulaterPOReleaseLineItem"}).navGrid("#customerInvoice_lineitemspager",{add:!0,edit:!0,del:!0,refresh:!0,search:!1},
{width:450,left:400,top:300,closeAfterEdit:!0,reloadAfterSubmit:!0,modal:!0,jqModel:!0,editCaption:"Edit Product",beforeShowForm:function(c){jQuery("#TblGrid_customerInvoice_lineitems #tr_note .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_note .CaptionTD").append("Product No: ");jQuery("#TblGrid_customerInvoice_lineitems #tr_note .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_customerInvoice_lineitems #tr_description .CaptionTD").empty();
jQuery("#TblGrid_customerInvoice_lineitems #tr_description .CaptionTD").append("Description: ");jQuery("#TblGrid_customerInvoice_lineitems #tr_quantityOrdered .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_quantityOrdered .CaptionTD").append("Qty: ");jQuery("#TblGrid_customerInvoice_lineitems #tr_quantityOrdered .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_customerInvoice_lineitems #tr_unitCost .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_unitCost .CaptionTD").append("Cost Each.: ");
jQuery("#TblGrid_customerInvoice_lineitems #tr_priceMultiplier .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_priceMultiplier .CaptionTD").append("Mult.: ");jQuery("#TblGrid_customerInvoice_lineitems #tr_priceMultiplier .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_customerInvoice_lineitems #tr_taxable .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_taxable .CaptionTD").append("Tax: ");$(function(){var b={},c="";
$("#note").autocomplete({minLength:1,timeout:1E3,select:function(b,c){var a=c.item.id,f=c.item.label;$("#prMasterId").val(a);-1!==f.indexOf("-")&&(a=f.split("-")[1].split("]")[0].split("["),$("#description").val(a[1]))},source:function(a,e){var g=a.term;g in b?e(b[g]):c=$.getJSON("jobtabs3/productCodeWithNameList",a,function(a,d,k){b[g]=a;k===c&&e(a)})},error:function(b){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});return!0},afterSubmit:function(c,b){return[!0,loadCustomerInvoice(a)]}},
{width:450,left:400,top:300,closeAfterAdd:!0,reloadAfterSubmit:!0,modal:!0,jqModel:!0,addCaption:"Add Product",beforeShowForm:function(c){if(""===a)return errorText="Please add 'Purchase Order'",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+errorText+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),jQuery(".ui-icon-closethick").trigger("click"),
!1;jQuery("#TblGrid_customerInvoice_lineitems #tr_note .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_note .CaptionTD").append("Product No: ");jQuery("#TblGrid_customerInvoice_lineitems #tr_note .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_customerInvoice_lineitems #tr_description .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_description .CaptionTD").append("Description: ");jQuery("#TblGrid_customerInvoice_lineitems #tr_quantityOrdered .CaptionTD").empty();
jQuery("#TblGrid_customerInvoice_lineitems #tr_quantityOrdered .CaptionTD").append("Qty: ");jQuery("#TblGrid_customerInvoice_lineitems #tr_quantityOrdered .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_customerInvoice_lineitems #tr_unitCost .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_unitCost .CaptionTD").append("Cost Each: ");jQuery("#TblGrid_customerInvoice_lineitems #tr_priceMultiplier .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_priceMultiplier .CaptionTD").append("Multiplier: ");
jQuery("#TblGrid_customerInvoice_lineitems #tr_priceMultiplier .CaptionTD").append('<span style="color:red;" class="mandatory">*</span>');jQuery("#TblGrid_customerInvoice_lineitems #tr_taxable .CaptionTD").empty();jQuery("#TblGrid_customerInvoice_lineitems #tr_taxable .CaptionTD").append("Tax: ");$(function(){var b={},c="";$("#note").autocomplete({minLength:1,timeout:1E3,select:function(b,c){var a=c.item.id,f=c.item.label;$("#prMasterId").val(a);-1!==f.indexOf("-")&&(a=f.split("-")[1].split("]")[0].split("["),
$("#description").val(a[1]))},source:function(a,e){var g=a.term;g in b?e(b[g]):c=$.getJSON("jobtabs3/productCodeWithNameList",a,function(a,d,k){b[g]=a;k===c&&e(a)})},error:function(b){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});return!0},onclickSubmit:function(c){return{vePoid:a}},afterSubmit:function(c,b){return[!0,loadCustomerInvoice(a)]}},{closeOnEscape:!0,reloadAfterSubmit:!0,modal:!0,jqModal:!0,width:300,left:450,top:350,caption:"Delete Product",msg:"Delete the Product Record?",
onclickSubmit:function(a){a=jQuery("#customerInvoice_lineitems").jqGrid("getGridParam","selrow");return{vePodetailId:jQuery("#customerInvoice_lineitems").getCell(a,10)}}},{})}jQuery(function(){jQuery("#cusinvoicetab").dialog({autoOpen:!1,width:850,title:"Customer Invoice",modal:!0,close:function(){return!0}})});
function invoiceshipToAddress(){var a=$("#rxCustomer_ID").text();operationVar="ship";$.ajax({url:"./jobtabs3/getBilltoAddress",type:"GET",data:{customerID:a,oper:operationVar},success:function(a){var b=$("#jobCustomerName_ID").text(),f=a.rxAddressId,d=a.address1,e=a.address2,g=a.city,h=a.state;a=a.zip;$("#rxAddressShipID").val(f);$("#customerShipToAddressID").val(b);$("#customerShipToAddressID1").val(d);$("#customerShipToAddressID2").val(e);$("#customerShipToCity").val(g);$("#customerShipToState").val(h);
$("#customerShipToZipID").val(a);document.getElementById("customerShipToAddressID").disabled=!0;document.getElementById("customerShipToAddressID1").disabled=!0;document.getElementById("customerShipToAddressID2").disabled=!0;document.getElementById("customerShipToCity").disabled=!0;document.getElementById("customerShipToState").disabled=!0;document.getElementById("customerShipToZipID").disabled=!0}})}
function invoicebillToAddress(){var a=$("#rxCustomer_ID").text();operationVar="bill";$.ajax({url:"./jobtabs3/getBilltoAddress",type:"GET",data:{customerID:a,oper:operationVar},success:function(a){var b=$("#jobCustomerName_ID").text(),f=a.rxAddressId,d=a.address1,e=a.address2,g=a.city,h=a.state;a=a.zip;$("#rxAddressBillID").val(f);$("#customerbillToAddressID").val(b);$("#customerbillToAddressID1").val(d);$("#customerbillToAddressID2").val(e);$("#customerbillToCity").val(g);$("#customerbillToState").val(h);
$("#customerbillToZipID").val(a);document.getElementById("customerbillToAddressID").disabled=!0;document.getElementById("customerbillToAddressID1").disabled=!0;document.getElementById("customerbillToAddressID2").disabled=!0;document.getElementById("customerbillToCity").disabled=!0;document.getElementById("customerbillToState").disabled=!0;document.getElementById("customerbillToZipID").disabled=!0}})}
function savecustomerinvoice(){var a=$("#custoemrInvoiceFormID").serialize(),c=$("#customerInvoice_subTotalID").val().replace(/[^0-9\.]+/g,""),b=$("#customerInvoice_frightID").val().replace(/[^0-9\.]+/g,""),f=$("#customerInvoice_taxId").val().replace(/[^0-9\.]+/g,""),d=$("#customerInvoice_totalID").val().replace(/[^0-9\.]+/g,""),e=$("#cusinvoicetab").dialog("option","title"),g=$("#shiping"),h=g.jqGrid("getGridParam","selrow"),m=$("#release"),k=m.jqGrid("getGridParam","selrow"),m=m.jqGrid("getCell",
k,"joReleaseDetailid"),k="";"New Customer Invoice"===e?k="add":(g.jqGrid("getCell",h,"veBillID"),k="edit");$.ajax({url:"./jobtabs5/updateCustomerInvoiceDetails",type:"POST",data:a+"&customerInvoice_subTotalName="+c+"&customerInvoice_frightname="+b+"&customerInvoice_taxName="+f+"&customerInvoice_totalName="+d+"&oper="+k+"&joReleaseDetailsID="+m,success:function(b){jQuery(newDialogDiv).html('<span><b style="color:Green;">Customer Invoice Details Updated.</b></span>');jQuery(newDialogDiv).dialog({modal:!0,
width:300,height:150,title:"Success.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close");jQuery("#cusinvoicetab").dialog("close");$("#release").trigger("reloadGrid")}}]}).dialog("open")}})}
function opencustomerinvoicedialog(){if("0"===jQuery("#release").getGridParam("records"))return jQuery(newDialogDiv).html('<span><b style="color:red;">Please add one release in "Release Grid".</b></span>'),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Warning.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;var a=$("#shiping"),c=a.jqGrid("getGridParam","selrow"),b=a.jqGrid("getCell",c,"customerDate"),f=a.jqGrid("getCell",c,"joReleaseDetailid"),
d=a.jqGrid("getCell",c,"veShipViaID");0!==jQuery("#shiping").getGridParam("records")?""===b?(b="Invoice not found, do you wish to create a new customer invoice for this release?",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+b+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Information.",buttons:{Yes:function(){jQuery(this).dialog("close");var b=$(".customerNameField").val(),a=$("#JobCustomerId").val();getCustomerInvoiceDetails(f,
a);$("#customerInvoice_customerInvoiceID").val(b);$("#customerInvoice_customerHiddnID").val(a);$("#customerInvoice_linecustomerInvoiceID").val(b);$("#customerInvoice_linecustomerHiddnID").val(a);$("#customerInvoice_invoiceDateID").val("");$("#customerInvoice_invoiceDateID").val(currenDate);$("#customerInvoice_shipDateID").val("");$("#customerInvoice_shipDateID").val(currenDate);$("#customerInvoice_dueDateID").val("");$("#customerInvoice_dueDateID").val(currenDate);$("#customerInvoice_lineshipDateID").val("");
$("#customerInvoice_lineshipDateID").val(currenDate);$("#customerInvoice_lineinvoiceDateID").val("");$("#customerInvoice_lineinvoiceDateID").val(currenDate);$("#shipViaCustomerSelectlineID option[value="+d+"]").attr("selected",!0);$("#shipViaCustomerSelectID option[value="+d+"]").attr("selected",!0);invoiceshipToAddress();invoicebillToAddress();$("#lineshipTo1").hide();$("#cusinvoicetab").dialog("option","title","");$("#cusinvoicetab").dialog("option","title","New Customer Invoice");jQuery("#cusinvoicetab").dialog("open")},
No:function(){jQuery(this).dialog("close")}}}).dialog("open")):(a=$(".customerNameField").val(),c=$("#JobCustomerId").val(),getCustomerInvoiceDetails(f,c),$("#customerInvoice_customerInvoiceID").val(a),$("#customerInvoice_customerHiddnID").val(c),$("#customerInvoice_linecustomerInvoiceID").val(a),$("#customerInvoice_linecustomerHiddnID").val(c),$("#customerInvoice_invoiceDateID").val(""),$("#customerInvoice_invoiceDateID").val(currenDate),$("#customerInvoice_shipDateID").val(""),$("#customerInvoice_shipDateID").val(currenDate),
$("#customerInvoice_dueDateID").val(""),$("#customerInvoice_dueDateID").val(currenDate),$("#customerInvoice_lineshipDateID").val(""),$("#customerInvoice_lineshipDateID").val(currenDate),$("#customerInvoice_lineinvoiceDateID").val(""),$("#customerInvoice_lineinvoiceDateID").val(currenDate),$("#shipViaCustomerSelectlineID option[value="+d+"]").attr("selected",!0),$("#shipViaCustomerSelectID option[value="+d+"]").attr("selected",!0),invoiceshipToAddress(),invoicebillToAddress(),$("#lineshipTo1").hide(),
$("#cusinvoicetab").dialog("option","title",""),$("#cusinvoicetab").dialog("option","title",b),jQuery("#cusinvoicetab").dialog("open")):(b="Invoice not found, do you wish to create a new customer invoice for this release?",jQuery(newDialogDiv).attr("id","msgDlg"),jQuery(newDialogDiv).html('<span><b style="color:red;">'+b+"</b></span>"),jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Information.",buttons:{Yes:function(){jQuery(this).dialog("close");var b=$(".customerNameField").val(),
a=$("#JobCustomerId").val();getCustomerInvoiceDetails(f);$("#customerInvoice_customerInvoiceID").val(b);$("#customerInvoice_customerHiddnID").val(a);$("#customerInvoice_linecustomerInvoiceID").val(b);$("#customerInvoice_linecustomerHiddnID").val(a);$("#customerInvoice_invoiceDateID").val("");$("#customerInvoice_invoiceDateID").val(currenDate);$("#customerInvoice_shipDateID").val("");$("#customerInvoice_shipDateID").val(currenDate);$("#customerInvoice_dueDateID").val("");$("#customerInvoice_dueDateID").val(currenDate);
$("#customerInvoice_lineshipDateID").val("");$("#customerInvoice_lineshipDateID").val(currenDate);$("#customerInvoice_lineinvoiceDateID").val("");$("#customerInvoice_lineinvoiceDateID").val(currenDate);$("#shipViaCustomerSelectlineID option[value="+d+"]").attr("selected",!0);$("#shipViaCustomerSelectID option[value="+d+"]").attr("selected",!0);invoiceshipToAddress();invoicebillToAddress();$("#lineshipTo1").hide();$("#cusinvoicetab").dialog("option","title","");$("#cusinvoicetab").dialog("option",
"title","New Customer Invoice");jQuery("#cusinvoicetab").dialog("open")},No:function(){jQuery(this).dialog("close")}}}).dialog("open"));return!0}function cancelcustomerinvoice(){$("#release").trigger("reloadGrid");jQuery("#cusinvoicetab").dialog("close")}function customershipBackWard(){$("#lineshipTo1").hide();$("#lineshipTo").show()}function customershipForWard(){$("#lineshipTo1").show();$("#lineshipTo").hide()}
function usinvoiceShiptoAddress(){$("#forWardId").show();$("#backWardId").show();$("#usinvoiceShipto").css({"background-image":"url(./../resources/images/us_select.png)",width:"63px",height:"28px"});$("#customerinvoiceShipto").css({"background-image":"url(./../resources/images/customer.png)",width:"63px",height:"28px"});$("#jobsiteinvoiceShipto").css({"background-image":"url(./../resources/images/jobsite.png)",width:"63px",height:"28px"});$("#otherinvoiceShipto").css({"background-image":"url(./../resources/images/other.png)",
width:"63px",height:"28px"});loadShipToAddress();return!0}
function customerinvoiceShiptoAddress(){$("#forWardId").css({display:"none"});$("#backWardId").css({display:"none"});$("#usinvoiceShipto").css({"background-image":"url(./../resources/images/us.png)",width:"63px",height:"28px"});$("#customerinvoiceShipto").css({"background-image":"url(./../resources/images/customer_select.png)",width:"63px",height:"28px"});$("#jobsiteinvoiceShipto").css({"background-image":"url(./../resources/images/jobsite.png)",width:"63px",height:"28px"});$("#otherinvoiceShipto").css({"background-image":"url(./../resources/images/other.png)",
width:"63px",height:"28px"});var a=$("#rxCustomer_ID").text();operationVar="ship";$.ajax({url:"./jobtabs3/getBilltoAddress",type:"GET",data:{customerID:a,oper:operationVar},success:function(a){var b=$("#jobCustomerName_ID").text(),f=a.rxAddressId,d=a.address1,e=a.address2,g=a.city,h=a.state;a=a.zip;$("#rxAddressShipID").val(f);$("#customerShipToAddressID").val(b);$("#customerShipToAddressID1").val(d);$("#customerShipToAddressID2").val(e);$("#customerShipToCity").val(g);$("#customerShipToState").val(h);
$("#customerShipToZipID").val(a);document.getElementById("customerShipToAddressID").disabled=!0;document.getElementById("customerShipToAddressID1").disabled=!0;document.getElementById("customerShipToAddressID2").disabled=!0;document.getElementById("customerShipToCity").disabled=!0;document.getElementById("customerShipToState").disabled=!0;document.getElementById("customerShipToZipID").disabled=!0}});return!0}
function jobsiteinvoiceShiptoAddress(){$("#forWardId").css({display:"none"});$("#backWardId").css({display:"none"});$("#usinvoiceShipto").css({"background-image":"url(./../resources/images/us.png)",width:"63px",height:"28px"});$("#customerinvoiceShipto").css({"background-image":"url(./../resources/images/customer.png)",width:"63px",height:"28px"});$("#jobsiteinvoiceShipto").css({"background-image":"url(./../resources/images/jobsite_select.png)",width:"63px",height:"28px"});$("#otherinvoiceShipto").css({"background-image":"url(./../resources/images/other.png)",
width:"63px",height:"28px"});$("#customerShipToAddressID").val(CustomName);$("#customerShipToAddressID1").val(jobLocation1);$("#customerShipToAddressID2").val(jobLocation2);$("#customerShipToCity").val(jobCity);$("#customerShipToState").val(jobState);$("#customerShipToZipID").val(jobZip);document.getElementById("customerShipToAddressID").disabled=!0;document.getElementById("customerShipToAddressID1").disabled=!0;document.getElementById("customerShipToAddressID2").disabled=!0;document.getElementById("customerShipToCity").disabled=
!0;document.getElementById("customerShipToState").disabled=!0;return document.getElementById("customerShipToZipID").disabled=!0}
function otherinvoiceShiptoAddress(){$("#forWardId").css({display:"none"});$("#backWardId").css({display:"none"});$("#usinvoiceShipto").css({"background-image":"url(./../resources/images/us.png)",width:"63px",height:"28px"});$("#customerinvoiceShipto").css({"background-image":"url(./../resources/images/customer.png)",width:"63px",height:"28px"});$("#jobsiteinvoiceShipto").css({"background-image":"url(./../resources/images/jobsite.png)",width:"63px",height:"28px"});$("#otherinvoiceShipto").css({"background-image":"url(./../resources/images/other_select.png)",
width:"63px",height:"28px"});$("#customerShipToAddressID").val("");$("#customerShipToAddressID1").val("");$("#customerShipToAddressID2").val("");$("#customerShipToCity").val("");$("#customerShipToState").val("");$("#customerShipToZipID").val("");document.getElementById("customerShipToAddressID").disabled=!1;document.getElementById("customerShipToAddressID1").disabled=!1;document.getElementById("customerShipToAddressID2").disabled=!1;document.getElementById("customerShipToCity").disabled=!1;document.getElementById("customerShipToState").disabled=
!1;document.getElementById("customerShipToZipID").disabled=!1;return!0}$(function(){var a={},c="";$("#customerinvoice_paymentTerms").autocomplete({minLength:2,timeout:1E3,select:function(a,c){var d=c.item.id;$("#customerinvoicepaymentId").val(d)},source:function(b,f){var d=b.term;d in a?f(a[d]):c=$.getJSON("employeeCrud/paymentType",b,function(b,g,h){a[d]=b;h===c&&f(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
$(function(){var a={},c="";$("#customerInvoice_TaxTerritory").autocomplete({minLength:2,timeout:1E3,select:function(a,c){var d=c.item.id;$("#customerTaxTerritory").val(d);d=c.item.taxValue;$("#customer_TaxTextValue").val(d);$("#customer_TaxTextValue").empty();$("#customer_TaxTextValue").append(d+"%")},source:function(b,f){var d=b.term;d in a?f(a[d]):c=$.getJSON("companycontroller/companyTax",b,function(b,g,h){a[d]=b;h===c&&f(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
$(function(){var a={},c="";$("#customerInvoice_salesRepsList").autocomplete({minLength:2,timeout:1E3,select:function(a,c){var d=c.item.id;$("#customerInvoice_salesRepId").val(d)},source:function(b,f){var d=b.term;d in a?f(a[d]):c=$.getJSON("salescontroller/salesrep",b,function(b,g,h){a[d]=b;h===c&&f(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
$(function(){var a={},c="";$("#customerInvoice_CSRList").autocomplete({minLength:2,timeout:1E3,select:function(a,c){var d=c.item.id;$("#customerInvoice_CSRId").val(d)},source:function(b,f){var d=b.term;d in a?f(a[d]):c=$.getJSON("employeeCrud/CSRList",b,function(b,g,h){a[d]=b;h===c&&f(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
$(function(){var a={},c="";$("#customerInvoice_SalesMgrList").autocomplete({minLength:2,timeout:1E3,select:function(a,c){var d=c.item.id;$("#customerInvoice_salesMgrId").val(d)},source:function(b,f){var d=b.term;d in a?f(a[d]):c=$.getJSON("employeeCrud/salesMGR",b,function(b,g,h){a[d]=b;h===c&&f(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
$(function(){var a={},c="";$("#customerInvoice_EngineersList").autocomplete({minLength:2,timeout:1E3,select:function(a,c){var d=c.item.id;$("#customerInvoice_engineerId").val(d)},source:function(b,f){var d=b.term;d in a?f(a[d]):c=$.getJSON("employeeCrud/engineer",b,function(b,g,h){a[d]=b;h===c&&f(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
$(function(){var a={},c="";$("#customerInvoice_PrjMgrList").autocomplete({minLength:2,timeout:1E3,select:function(a,c){var d=c.item.id;$("#customerInvoice_prjMgrId").val(d)},source:function(b,f){var d=b.term;d in a?f(a[d]):c=$.getJSON("employeeCrud/projectManager",b,function(b,g,h){a[d]=b;h===c&&f(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
function getCustomerInvoiceDetails(a,c){$.ajax({url:"./jobtabs5/getCustomerInvoiceDetails",type:"POST",data:{releaseDetailID:a,customerID:c},success:function(a){if(""!==a){var c=new Date(a.dueDate),d=new Date(a.invoiceDate),e=new Date(a.shipDate),g=a.invoiceNumber,h=a.freight,m=a.costTotal,k=a.subtotal,l=a.taxRate,n=a.veShipViaId,p=a.prToWarehouseId,q=a.coDivisionId,r=a.trackingNumber,x=a.doNotMail,y=a.cuInvoiceId,s=Number(a.cuAssignmentId0),t=Number(a.cuAssignmentId1),u=Number(a.cuAssignmentId2),
v=Number(a.cuAssignmentId3),w=Number(a.cuAssignmentId4);$("#customerInvoice_salesRepId").val(s);$("#customerInvoice_CSRId").val(t);$("#customerInvoice_salesMgrId").val(u);$("#customerInvoice_engineerId").val(v);$("#customerInvoice_prjMgrId").val(w);c=c.getUTCMonth()+1+"/"+c.getUTCDate()+"/"+c.getUTCFullYear();d=d.getUTCMonth()+1+"/"+d.getUTCDate()+"/"+d.getUTCFullYear();e=e.getUTCMonth()+1+"/"+e.getUTCDate()+"/"+e.getUTCFullYear();$("#customerInvoice_dueDateID").val(c);$("#customerInvoice_invoiceDateID").val(d);
$("#customerInvoice_lineinvoiceDateID").val(d);$("#customerInvoice_invoiceNumberId").val(g);$("#customerInvoice_lineinvoiceNumberId").val(g);$("#customerInvoice_shipDateID").val(e);$("#customerInvoice_lineshipDateID").val(e);$("#customerInvoice_proNumberID").val(r);$("#customerInvoice_lineproNumberID").val(r);$("#customerInvoice_subTotalID").val(formatCurrency(k));$("#customerInvoice_frightID").val(formatCurrency(h));$("#customerInvoice_taxId").val(formatCurrency(l));$("#customerInvoice_totalID").val(formatCurrency(m));
$("#customerInvoice_linesubTotalID").val(formatCurrency(k));$("#customerInvoice_linefrightID").val(formatCurrency(h));$("#customerInvoice_linetaxId").val(formatCurrency(l));$("#customerInvoice_linetotalID").val(formatCurrency(m));$("#customerInvoice_ID").val(y);1==x&&$("#customerInvoie_doNotMailID").attr("checked",!0);$("#customer_Divisions option[value="+q+"]").attr("selected",!0);$("#prWareHouseSelectID option[value="+p+"]").attr("selected",!0);$("#shipViaCustomerSelectID option[value="+n+"]").attr("selected",
!0);$("#prWareHouseSelectlineID option[value="+p+"]").attr("selected",!0);$("#shipViaCustomerSelectlineID option[value="+n+"]").attr("selected",!0);!0===a.usePostDate&&($("#postDateChkID").prop("checked",!0),$("#postDateID").show());$.ajax({url:"./jobtabs5/getAssigneeDetails",type:"POST",data:{assignee0:s,assignee1:t,assignee2:u,assignee3:v,assignee4:w},success:function(a){$("#customerInvoice_salesRepsList").val(a.cuAssignmentId0);$("#customerInvoice_CSRList").val(a.cuAssignmentId1);$("#customerInvoice_SalesMgrList").val(a.cuAssignmentId2);
$("#customerInvoice_EngineersList").val(a.cuAssignmentId3);$("#customerInvoice_PrjMgrList").val(a.cuAssignmentId4)}})}}});return!0}
function saveCustomerPONumber(){if(!$("#customerPOFormID").validationEngine("validate"))return!1;var a=$("#release"),c=a.jqGrid("getGridParam","selrow"),a=a.jqGrid("getCell",c,"joReleaseDetailid"),c=$("#joMaster_ID").text(),b=$("#customerPONumberID").val().replace("$ ","");$.ajax({url:"./jobtabs5/saveCustomerPONumber",type:"GET",data:{customerPONumber:b,releaseDetail:a,joMasterID:c},success:function(a){jQuery(newDialogDiv).attr("id","msgDlg");jQuery(newDialogDiv).html('<span><b style="color: green;">Customer PO Number Saved Successfully.</b></span>');
jQuery(newDialogDiv).dialog({modal:!0,width:300,height:150,title:"Success.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close");$("#release").trigger("reloadGrid")}}]}).dialog("open")}});return!1}function removeDollorSym(){var a=$("#customerPONumberID").val().replace("$ ","");$("#customerPONumberID").val(a);return!1};
©2009 Google - Terms of Service - Privacy Policy - Google Home