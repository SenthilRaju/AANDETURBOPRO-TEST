var message=$("#homeHiddenUseNameID").val();$("#search").hide();var jobCustomer="",status="";$("#home_down_image").vTicker({speed:500,pause:3E3,showItems:3,animation:"fade",mousePause:!0,height:180,direction:"up"});$(document).ready(function(){recentlyOpenedJob();getWeatherForecast()});
function recentlyOpenedJob(){$("#lastOpenedJobs").jqGrid({url:"./job_controller/jobHistory",datatype:"JSON",mtype:"POST",pager:"",colNames:["Job #","Job","Date","Bid Date"],colModel:[{name:"jobNumber",index:"jobNumber",align:"left",width:20,editable:!0,hidden:!0},{name:"jobName",index:"jobName",align:"left",width:230,formatter:formatter,cellattr:function(a,d,b,c,e){return'style="white-space:normal"'}},{name:"jobOpenedDateStr",index:"jobOpenedDateStr",width:80,align:"center",formatter:dateFormatter,
hidden:!0},{name:"jobBidDateStr",index:"jobBidDateStr",width:80,align:"center",formatter:dateFormatter,hidden:!1}],rowNum:13,pgbuttons:!0,recordtext:"",viewrecords:!0,pager:"",hidegrid:!1,loadtext:"loading..",sortname:"",sortorder:"asc",imgpath:"themes/basic/images",caption:"Recently Opened Jobs",height:"auto",draggable:!0,position:"fixed",modal:!0,width:320,altRows:!0,altclass:"myAltRowClass",rownumWidth:45,loadComplete:function(a){},loadError:function(a,d,b){},ondblClickRow:function(a){a=jQuery(this).getRowData(a);
var d=a.jobNumber,b=$.trim(a.jobName),c="";$.ajax({url:"./job_controller/jobStatusHome",mType:"GET",data:{jobNumber:d},success:function(a){c=a;b=b.replace(/&/g,"``");b=b.replace(/#/,"__");document.location.href="./jobflow?token=view&jobNumber="+d+"&jobName="+b+"&jobStatus="+c}})},onLoadComplete:function(){!1===ts.p.shrinkToFit&&(initwidth+=brd*cl)},jsonReader:{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata"}})}
function getWeatherForecast(){$("#homeHiddenUserID").val();$.ajax({type:"GET",url:"http://api.worldweatheronline.com/free/v1/weather.ashx?q=30060&format=JSON&num_of_days=3&key=4cg5md4epmkzmc52d77gqvnf",async:!1,contentType:"application/json",dataType:"jsonp",success:function(a){console.log(a.data);console.log(a.data.current_condition[0].temp_C);var d='<table><tr><td colspan="2"><b><label>Current Weather: </label></b></td></tr><tr><td><label>Temperature: '+a.data.current_condition[0].temp_C+"<sup> o</sup></label><br/><label>Weather: "+
a.data.current_condition[0].weatherDesc[0].value+'</label></td><td><img alt="" height="40" width="40" style="border-radius:9px;border:thin outset;"src="'+a.data.current_condition[0].weatherIconUrl[0].value+'"></td></tr><tr><td colspan="2"><b><label>Forecast: </label></b></td></tr></table><input id="animation" type="checkbox" style="display: none;"></input><div id="scroller"><ul id="list">';console.log(a.data.weather.length);for(var b=0;b<a.data.weather.length;b++){var c=a.data.weather[b].date;console.log(a.data.weather[b].date);
d=d+"<li><table><tr><td><table><tr><td><b><label>"+c+'</label></b></td><td><img alt="" height="32" width="32"style="border-radius:9px;border:thin outset;" src="'+a.data.weather[b].weatherIconUrl[0].value+'"/></td></tr><tr><td colspan=""><label>Max </label></td><td colspan=""><label>: </label></td><td><label>'+a.data.weather[b].tempMaxF+'<sup> o</sup> F</label></td></tr><tr><td colspan=""><label>Min </label></td><td colspan=""><label>: </label></td><td><label>'+a.data.weather[b].tempMinC+'<sup> o</sup> F</label></td></tr><tr><td colspan=""><label>Weather </label></td><td colspan=""><label>: </label></td><td><label>'+
a.data.weather[b].weatherDesc[0].value+"</label></td></tr></table></td></tr></table></li>"}d+="</ul></div>";$(".weatherWidget").html(d);$(".weatherWidget").append({modal:!0,width:500,height:450,title:"Weather Widget",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open")},error:function(a){console.log(a.message)}});return!0}
function zipeCode(){var a=$("#zipCodeID").val();if(""===a)return a=jQuery(document.createElement("div")),jQuery(a).html('<span style="color:red;"><b>Please provide a zipcode.</b></span>'),jQuery(a).dialog({modal:!0,width:500,height:250,title:"Error.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open"),!1;$.ajax({type:"POST",url:"./homecontroller/userzipcode",data:{zipCodeID:a},success:function(a){return!0},error:function(a,b,c){a=$(a.responseText).find("u").html();
b=jQuery(document.createElement("div"));jQuery(b).html('<span style="color:red;"><b>Error: '+a+"</b></span>");jQuery(b).dialog({modal:!0,width:500,height:250,title:"Fatal Error.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open");return!1}})}function dateFormatter(a,d,b){return a}function formatter(a,d,b){return a.replace("`"," ").replace("`"," ").replace("`"," ").replace("`"," ")}
$(function(){var a={},d="";$("#jobsearch").autocomplete({minLength:3,timeout:1E3,sortResults:!0,open:function(){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")},select:function(a,c){var d=c.item.value.replace("[","`").split("`"),f=d[0],f="`"+f+"`",h=d[1].replace("]"," ");$.ajax({url:"./search/searchjobcustomer",mType:"GET",data:{jobnumber:h,jobname:f},success:function(a){$.each(a,function(a,b){status=b.jobStatus;jobCustomer=b.customerName});null===jobCustomer&&(jobCustomer="");
updateJobstatus(h,status);f=f.replace("`","");f=f.replace("`","");window.location.href="./jobflow?token=view&jobNumber="+h+"&jobName="+f+"&jobCustomer="+jobCustomer+"&jobStatus="+status+""},error:function(a){a=$(a.responseText).find("u").html();var b=jQuery(document.createElement("div"));jQuery(b).html('<span style="color:red;"><b>Error: '+a+"</b></span>");jQuery(b).dialog({modal:!0,width:500,height:250,title:"Fatal Error.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open")}})},
source:function(b,c){var e=b.term;e in a?c(a[e]):d=$.getJSON("search/searchjoblist",b,function(b,h,k){a[e]=b;k===d&&c(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});
$(function(){var a={},d="";$("#rolodex").autocomplete({minLength:3,timeout:1E3,open:function(){$(".ui-autocomplete").prepend('<div style="font-size: 15px;"><b><a href="./rolodexList?oper=add" style="color:#3E8DC6;font-family: Verdana,Arial,sans-serif;font-size: 0.8em;">+ Add New Rolodex</a></b></div>');$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")},select:function(a,c){var d=c.item.value;$.ajax({url:"./search/searchrolodex",mType:"GET",data:{rolodex:d},success:function(a){var b=
"";$.each(a,function(a,c){entityValue=c.entity;b=c.pk_fields});var c=d.split(": ");a=c[0];var c=c[1].split(",  ")[0].replace("&","and").replace("&","and"),g="";"EMP"==a&&(g=a.replace("EMP","employeedetails"));"VEND"==a&&(g=a.replace("VEND","vendordetails"));"CUST"==a&&(g=a.replace("CUST","customerdetails"));"ARCH"==a&&(g=a.replace("ARCH","architectDetails"));"ENGR"==a&&(g=a.replace("ENGR","engineerDetails"));"ARCH/ENGR"==a&&(g=a.replace("ARCH/ENGR","architectDetails"));"G.C"==a&&(g=a.replace("G.C",
"rolodexdetails"));location.href="./"+g+"?rolodexNumber="+b+"&name=`"+c+"`"},error:function(a){a=$(a.responseText).find("u").html();var b=jQuery(document.createElement("div"));jQuery(b).html('<span style="color:red;"><b>Error: '+a+"</b></span>");jQuery(b).dialog({modal:!0,width:500,height:250,title:"Fatal Error.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open")}})},source:function(b,c){var e=b.term;e in a?c(a[e]):d=$.getJSON("search/searchrolodexlist",b,function(b,
h,k){a[e]=b;k===d&&c(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}});$("#inventorysearch").autocomplete({minLength:3,timeout:1E3,open:function(){$(".ui-autocomplete").prepend('<div style="font-size: 15px;"><b><a href="./inventoryDetails?token=new" style="color:#3E8DC6;font-family: Verdana,Arial,sans-serif;font-size: 0.8em;">+ Add New Inventory</a></b></div>');$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")},select:function(a,c){var d=
[],d=c.item.value.split("|");$("#inventorysearch").val(d[1]);location.href="./inventoryDetails?token=view&inventoryId="+d[0]+"&itemCode="+d[2]},source:function(b,c){var e=b.term;e in a?c(a[e]):d=$.getJSON("search/searchinventory",b,function(b,h,k){a[e]=b;k===d&&c(b)})},error:function(a){$(".ui-autocomplete-loading").removeClass("ui-autocomplete-loading")}})});function createNewJob(){document.location.href="./jobflow?token=new"}
function getJobs(){if(""===$("#jobsearch").val())return!1;$.ajax({url:"./search/searchjob",mType:"GET",timeout:1E3,data:{jobsearch:$("#jobsearch").val()},success:function(a){var d=[];$.each(a,function(a,b){d[a]=b.searchText});a=d.toString().split("|");var b=a[0],c=a[1],c=c.replace(/&/g,"``"),c=c.replace(/#/,"__");$.ajax({url:"./search/searchjobcustomer",mType:"GET",data:{jobnumber:b,jobname:c},success:function(a){$.each(a,function(a,b){status=b.jobStatus;jobCustomer=b.customerName});null===jobCustomer&&
(jobCustomer="");document.location.href="./jobflow?token=view&jobNumber="+b+"&jobName="+c+"&jobCustomer="+jobCustomer+"&jobStatus="+status+""},error:function(a){}})},error:function(a){a=$(a.responseText).find("u").html();var d=jQuery(document.createElement("div"));jQuery(d).html('<span style="color:red;"><b>Error: '+a+"</b></span>");jQuery(d).dialog({modal:!0,width:500,height:250,title:"Fatal Error.",buttons:[{height:35,text:"OK",click:function(){$(this).dialog("close")}}]}).dialog("open")}});return!0}
function getRolodex(){if(""===$("#rolodex").val())return!1;$.ajax({url:"./search/searchrolodex",timeout:1E3,mType:"GET",data:{rolodex:$("#rolodex").val()},success:function(a){var d="";$.each(a,function(a,b){entityValue=b.entity;d=b.pk_fields});var b=$("#rolodex").val().split(":");a=b[0];var b=b[1].split(",")[0],c="";"EMP"==a&&(c=a.replace("EMP","employeedetails"));"VEND"==a&&(c=a.replace("VEND","vendordetails"));"CUST"==a&&(c=a.replace("CUST","customerdetails"));"ARCH"==a&&(c=a.replace("ARCH","architectDetails"));
"ENGR"==a&&(c=a.replace("ENGR","engineerDetails"));"ARCH/ENGR"==a&&(c=a.replace("ARCH/ENGR","architectDetails"));"G.C"==a&&(c=a.replace("G.C","rolodexdetails"));document.location.href="./"+c+"?rolodexNumber="+d+"&name="+b+""},error:function(a){}});return!0};